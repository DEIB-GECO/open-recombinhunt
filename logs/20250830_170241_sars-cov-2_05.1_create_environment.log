2025-08-30 17:02:41,764 - INFO - Logging initialized. Log file at: logs/20250830_170241_sars-cov-2_05.1_create_environment.log
2025-08-30 17:02:41,764 - INFO - Virus is 'sars-cov-2'. Using Nextstrain reformatted as input.
2025-08-30 17:02:41,764 - INFO - Environment files will be saved to: environments/sars-cov-2/dist0size0
2025-08-30 17:02:41,764 - INFO - Loading data from: results/nextstrain_output/sars-cov-2/nextstrain_reformatted.tsv
2025-08-30 17:03:20,036 - INFO - Initial row count: 5,029,153
2025-08-30 17:03:22,573 - INFO - Dropped 270 rows with missing or empty 'mutations' column.
2025-08-30 17:03:22,574 - INFO - Row count after cleaning: 5,028,883
2025-08-30 17:03:22,574 - INFO - Calculating change probabilities...
2025-08-30 17:03:22,574 - INFO -   Total sequences for calculation: 5,028,883
2025-08-30 17:04:22,678 - INFO -   Found 82,093 unique mutations across all sequences.
2025-08-30 17:04:22,798 - INFO -   Finished calculating change probabilities. Shape of result: (82093, 2)
2025-08-30 17:04:28,475 - INFO - Calculating genome and variation counts per lineage...
2025-08-30 17:04:28,720 - INFO -   Found 4,457 unique lineages in the dataset.
2025-08-30 17:13:20,348 - INFO -   Finished calculating genome and variation counts.
2025-08-30 17:13:20,348 - INFO - 
Calculating 'lc_df.parquet'...
2025-08-30 17:13:20,349 - INFO - 
--- Running common logic: calculating lineage mutation frequencies ---
2025-08-30 17:13:20,350 - INFO - Selected 3358 lineages with at least 10 genomes.
2025-08-30 17:13:28,206 - INFO - Removed 0 mutations that were not characteristic of any lineage.
2025-08-30 17:13:28,246 - INFO - lc_df calculation complete.
2025-08-30 17:13:28,260 - INFO - 
Calculating 'change2lineage_probability.parquet'...
2025-08-30 17:13:28,260 - INFO - 
--- Running common logic: calculating lineage mutation frequencies ---
2025-08-30 17:13:28,261 - INFO - Selected 3358 lineages with at least 10 genomes.
2025-08-30 17:15:05,868 - INFO - change2lineage_probability calculation complete.
2025-08-30 17:15:05,868 - INFO - 
Calculating 'lc_quality_df.parquet'...
2025-08-30 17:15:05,873 - INFO - lc_quality_df calculation complete.
2025-08-30 17:15:05,873 - INFO - Saving environment files...
2025-08-30 17:15:07,126 - INFO - Virus is 'sars-cov-2'. Saving two versions of lineage characterisations.
2025-08-30 17:15:21,844 - INFO - Calculating genome and variation counts per lineage...
2025-08-30 17:15:22,071 - INFO -   Found 4,325 unique lineages in the dataset.
2025-08-30 17:24:11,931 - INFO -   Finished calculating genome and variation counts.
2025-08-30 17:24:12,864 - INFO - 
Calculating 'change2lineage_probability.parquet'...
2025-08-30 17:24:12,864 - INFO - 
--- Running common logic: calculating lineage mutation frequencies ---
2025-08-30 17:24:12,865 - INFO - Selected 3257 lineages with at least 10 genomes.
2025-08-30 17:25:47,845 - INFO - change2lineage_probability calculation complete.
2025-08-30 17:25:47,845 - INFO - 
Calculating 'lc_df.parquet'...
2025-08-30 17:25:47,845 - INFO - 
--- Running common logic: calculating lineage mutation frequencies ---
2025-08-30 17:25:47,846 - INFO - Selected 3257 lineages with at least 10 genomes.
2025-08-30 17:25:55,373 - INFO - Removed 0 mutations that were not characteristic of any lineage.
2025-08-30 17:25:55,410 - INFO - lc_df calculation complete.
2025-08-30 17:26:07,933 - INFO - Environment creation complete.
