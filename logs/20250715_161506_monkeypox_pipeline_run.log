2025-07-15 16:15:06,358 - INFO - Logging initialized. Log file at: logs/20250715_161506_monkeypox_pipeline_run.log
2025-07-15 16:15:06,358 - INFO - ================== STARTING PIPELINE FOR: MONKEYPOX ==================
2025-07-15 16:15:06,358 - INFO - --- Executing: /home/topcuoglu/miniconda3/envs/orh/bin/python3 src/02_preprocessing/ncbi/prep_metadata_ncbi.py --virus monkeypox --config config/config.yaml ---
2025-07-15 16:15:07,306 - INFO - Stdout from step:
INFO: Logging initialized. Log file at: logs/20250715_161506_monkeypox_02.1_prep_metadata_ncbi.log
INFO: Loading raw metadata from data/raw/monkeypox/raw_metadata.tsv...
INFO: Step 1: Applying quality filters from config and checking for special characters in ID...
INFO:   Filter 'Isolate Collection date notna None': Removed 474 rows.
INFO:   Filter 'Accession notna None': Removed 0 rows.
INFO:   Filter 'Length notna None': Removed 0 rows.
INFO:   Filter 'Length >= 180000': Removed 187 rows.
INFO:   Filter 'Special Chars in ID': Removed 0 rows.
INFO: Step 2: Processing lineage column...
INFO: Using source column 'Virus Pangolin Classification' for lineage information.
INFO:   Identified and removed 1411 non-classified rows (missing 'Virus Pangolin Classification').
INFO: Step 3: Performing final formatting on date and location columns...
INFO: Formatting date columns...
INFO:   - Analyzing and formatting 'Collection date'
INFO:     Date format statistics for 'Collection date':
INFO:       YYYY-MM-DD format: 4276
INFO:       YYYY-MM format   : 3901
INFO:       YYYY format      : 273
INFO:       Other/unparseable: 0
INFO:       Missing (NA)     : 0
INFO:   - Analyzing and formatting 'Submission date'
INFO:     Date format statistics for 'Submission date':
INFO:       YYYY-MM-DD format: 0
INFO:       YYYY-MM format   : 0
INFO:       YYYY format      : 0
INFO:       Other/unparseable: 8450
INFO:       Missing (NA)     : 0
INFO: Formatting 'Location' column by combining 'Geographic Region' and 'Geographic Location'...
INFO: Preprocessing complete. Final dataset has 8450 rows.
INFO: Saving processed metadata (8450 rows) to data/processed/monkeypox/metadata.tsv...
INFO: Saving 661 quality-filtered sequence IDs to data/processed/monkeypox/filtered_sequence_ids.txt...
INFO: Saving 1411 non-classified sequence IDs to data/processed/monkeypox/non_classified_sequence_ids.txt...
INFO: Script finished successfully.

2025-07-15 16:15:07,307 - INFO - --- Step Succeeded: /home/topcuoglu/miniconda3/envs/orh/bin/python3 src/02_preprocessing/ncbi/prep_metadata_ncbi.py --virus monkeypox --config config/config.yaml ---
2025-07-15 16:15:07,307 - INFO - --- Executing: /home/topcuoglu/miniconda3/envs/orh/bin/python3 src/02_preprocessing/common/prep_fasta.py --virus monkeypox --config config/config.yaml ---
2025-07-15 16:15:28,703 - INFO - Stdout from step:
INFO: Logging initialized. Log file at: logs/20250715_161507_monkeypox_02.2_prep_fasta.log
INFO: Loading IDs of sequences to be dropped...
INFO: Loading IDs from: data/processed/monkeypox/filtered_sequence_ids.txt
INFO: Loaded 661 unique IDs.
INFO: Loading IDs from: data/processed/monkeypox/non_classified_sequence_ids.txt
INFO: Loaded 1411 unique IDs.
INFO: NUmber of Filtered IDs: 661
INFO: Number of Non-Classified IDs: 1411
INFO: Total unique IDs to drop from FASTA file: 2072
INFO: Filtering FASTA file: data/raw/monkeypox/raw_sequences.fasta...
INFO: Removing sequences whose ID is in the combined dropped list (2072 total IDs).
INFO: FASTA Filtering Summary:
INFO:   Original sequences read: 10522
INFO:   Sequences dropped      : 2072
INFO:   Sequences kept         : 8450
INFO: Filtered FASTA saved to  : data/processed/monkeypox/sequences.fasta
INFO: Script finished successfully.

2025-07-15 16:15:28,703 - INFO - --- Step Succeeded: /home/topcuoglu/miniconda3/envs/orh/bin/python3 src/02_preprocessing/common/prep_fasta.py --virus monkeypox --config config/config.yaml ---
2025-07-15 16:15:28,703 - INFO - --- Executing: /home/topcuoglu/miniconda3/envs/orh/bin/python3 src/02_preprocessing/common/prep_ref.py --virus monkeypox --config config/config.yaml ---
2025-07-15 16:15:28,808 - INFO - Stdout from step:
INFO: Logging initialized. Log file at: logs/20250715_161528_monkeypox_02.3_prep_ref.log
INFO: Copying reference sequence...
INFO:   Source: data/raw/monkeypox/reference.fasta
INFO:   Destination: data/processed/monkeypox/reference.fasta
INFO: Reference sequence successfully copied to processed directory.
INFO: Script finished successfully.

2025-07-15 16:15:28,808 - INFO - --- Step Succeeded: /home/topcuoglu/miniconda3/envs/orh/bin/python3 src/02_preprocessing/common/prep_ref.py --virus monkeypox --config config/config.yaml ---
2025-07-15 16:15:28,808 - INFO - --- Executing: /home/topcuoglu/miniconda3/envs/orh/bin/python3 src/03_haplocov/run_haplocov.py --virus monkeypox --config config/config.yaml ---
2025-07-15 16:29:56,372 - INFO - Stdout from step:
INFO: Logging initialized. Log file at: logs/20250715_161528_monkeypox_03_run_haplocov.log
INFO: --- Starting Step 3: Run HaploCoV for 'monkeypox' ---
INFO: Created temporary working directory: results/haplocov_output/monkeypox/dist3size10/temp_work
INFO: Creating symbolic links for input files in temporary directory...
INFO: Executing HaploCoV with designation_mode: 'haplocov'
INFO: Executing: perl ../../../../../libs/haplocov/addToTableNCBI.pl --metadata metadata.tsv --ref reference.fasta --seq sequences.fasta --outfile out.HaploCoV --nproc 16
INFO: Executing: perl ../../../../../libs/haplocov/computeDefining.pl out.HaploCoV
INFO: Executing: perl ../../../../../libs/haplocov/assign.pl --dfile out.HaploCoV.definingVariants.txt --infile out.HaploCoV --outfile out.HaploCoV.assigned
INFO: Executing: perl ../../../../../libs/haplocov/augmentClusters.pl --metafile out.HaploCoV.assigned --deffile out.HaploCoV.definingVariants.txt --posFile out.HaploCoV.frequentVariants.txt --outfile out.HaploCoV.definingVariantsNew.txt --dist 3 --size 10
INFO: Executing: perl ../../../../../libs/haplocov/assign.pl --dfile out.HaploCoV.definingVariantsNew.txt --infile out.HaploCoV --outfile out.HaploCoV.assignedNew
INFO: Executing: cut -f 10 out.HaploCoV.assignedNew | sort | uniq -c > monkeypox-report.txt
INFO: Moving final output file 'out.HaploCoV.assignedNew' to 'results/haplocov_output/monkeypox/dist3size10/haplocov_assigned.tsv'
INFO: HaploCoV step completed.
INFO: HaploCoV step finished successfully.

2025-07-15 16:29:56,373 - INFO - --- Step Succeeded: /home/topcuoglu/miniconda3/envs/orh/bin/python3 src/03_haplocov/run_haplocov.py --virus monkeypox --config config/config.yaml ---
2025-07-15 16:29:56,373 - INFO - --- Executing: /home/topcuoglu/miniconda3/envs/orh/bin/python3 src/04_postprocessing/format_haplocov_variations.py --virus monkeypox --config config/config.yaml ---
2025-07-15 16:29:57,512 - INFO - Stdout from step:
INFO: Logging initialized. Log file at: logs/20250715_162956_monkeypox_04_postprocess_haplocov.log
INFO: Loading HaploCoV output from: results/haplocov_output/monkeypox/dist3size10/haplocov_assigned.tsv
INFO: Reformatting mutations in the 'listV' column...
INFO: Saving reformatted data to: results/haplocov_output/monkeypox/dist3size10/haplocov_reformatted.tsv
INFO: Script finished successfully.

2025-07-15 16:29:57,512 - WARNING - Stderr from step:

Formatting mutations:   0%|          | 0/8450 [00:00<?, ?it/s]
Formatting mutations:  46%|████▋     | 3912/8450 [00:00<00:00, 39116.96it/s]
Formatting mutations:  93%|█████████▎| 7824/8450 [00:00<00:00, 38601.67it/s]
Formatting mutations: 100%|██████████| 8450/8450 [00:00<00:00, 37660.53it/s]

2025-07-15 16:29:57,512 - INFO - --- Step Succeeded: /home/topcuoglu/miniconda3/envs/orh/bin/python3 src/04_postprocessing/format_haplocov_variations.py --virus monkeypox --config config/config.yaml ---
2025-07-15 16:29:57,512 - INFO - --- Executing: /home/topcuoglu/miniconda3/envs/orh/bin/python3 src/05_prepare_recombinhunt/create_environment.py --virus monkeypox --config config/config.yaml ---
2025-07-15 16:29:59,771 - INFO - Stdout from step:
INFO: Logging initialized. Log file at: logs/20250715_162958_monkeypox_05.1_create_environment.log
INFO: Virus is 'monkeypox'. Using HaploCoV reformatted output as input.
INFO: Environment files will be saved to: environments/monkeypox/dist3size10
INFO: Loading data from: results/haplocov_output/monkeypox/dist3size10/haplocov_reformatted.tsv
INFO: Initial row count: 8,450
INFO: Dropped 1 rows with missing or empty 'mutations' column.
INFO: Row count after cleaning: 8,449
INFO: Calculating change probabilities...
INFO:   Total sequences for calculation: 8,449
INFO:   Found 9,281 unique mutations across all sequences.
INFO:   Finished calculating change probabilities. Shape of result: (9281, 2)
INFO: Calculating genome and variation counts per lineage...
INFO:   Found 90 unique lineages in the dataset.
INFO:   Finished calculating genome and variation counts.
INFO: 
Calculating 'lc_df.parquet'...
INFO: 
--- Running common logic: calculating lineage mutation frequencies ---
INFO: Selected 90 lineages with at least 10 genomes.
INFO: Removed 0 mutations that were not characteristic of any lineage.
INFO: lc_df calculation complete.
INFO: 
Calculating 'change2lineage_probability.parquet'...
INFO: 
--- Running common logic: calculating lineage mutation frequencies ---
INFO: Selected 90 lineages with at least 10 genomes.
INFO: change2lineage_probability calculation complete.
INFO: 
Calculating 'lc_quality_df.parquet'...
INFO: lc_quality_df calculation complete.
INFO: Saving environment files...
INFO: Environment creation complete.

2025-07-15 16:29:59,771 - INFO - --- Step Succeeded: /home/topcuoglu/miniconda3/envs/orh/bin/python3 src/05_prepare_recombinhunt/create_environment.py --virus monkeypox --config config/config.yaml ---
2025-07-15 16:29:59,771 - INFO - --- Executing: /home/topcuoglu/miniconda3/envs/orh/bin/python3 src/05_prepare_recombinhunt/create_samples.py --virus monkeypox --config config/config.yaml ---
2025-07-15 16:30:00,782 - INFO - Stdout from step:
INFO: Logging initialized. Log file at: logs/20250715_163000_monkeypox_05.2_create_samples.log
INFO: --- Starting Step 5.2: Create Samples for 'monkeypox' ---
INFO: Virus is 'monkeypox'. Using HaploCoV reformatted output as input.
INFO: Sample files will be saved to: samples/monkeypox/dist3size10
INFO: Loading data from: results/haplocov_output/monkeypox/dist3size10/haplocov_reformatted.tsv
INFO: Cleaning data by dropping rows with missing pangoLin or mutations...
WARNING: Found 1 sequences with missing 'mutations'. They will be dropped.
WARNING:   Dropped IDs (missing mutations): ['NC_063383.1']
INFO: Initially, there were 8450 rows.
INFO: Data cleaning complete. 8449 rows remaining for sample creation.
INFO: Grouping by lineage and creating sample files...
INFO:   Saved: samples/monkeypox/dist3size10/samples_A.csv (66 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_A.1.csv (16 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_A.1.NmC1.csv (239 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_A.1.NmC2.csv (80 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_A.1.NmC3.csv (63 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_A.2.csv (33 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_A.2.1.csv (16 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_A.2.2.csv (113 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_A.2.3.csv (59 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_A.3.csv (11 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.csv (435 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.1.csv (400 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.1.NmC1.csv (35 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.10.csv (103 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.11.csv (68 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.11.NmC1.csv (48 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.11.NmC2.csv (36 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.12.csv (85 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.12.NmC1.csv (50 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.12.NmC2.csv (25 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.13.csv (383 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.13.NmC1.csv (393 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.13.NmC2.csv (231 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.13.NmC3.csv (122 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.14.csv (40 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.15.csv (19 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.16.csv (26 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.17.csv (15 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.17.NmC1.csv (370 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.17.NmC2.csv (180 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.17.NmC3.csv (50 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.17.NmC4.csv (120 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.17.NmC5.csv (112 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.17.NmC6.csv (202 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.18.csv (68 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.19.csv (15 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.2.csv (131 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.2.NmC1.csv (56 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.2.NmC2.csv (64 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.2.NmC3.csv (24 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.2.NmC4.csv (23 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.2.NmC5.csv (20 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.2.NmC6.csv (58 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.20.csv (91 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.20.NmC1.csv (107 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.21.csv (74 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.22.csv (39 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.22.NmC1.csv (25 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.23.csv (11 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.3.csv (113 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.3.NmC1.csv (57 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.3.NmC2.csv (34 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.4.csv (36 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.5.csv (23 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.6.csv (46 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.7.csv (79 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.7.NmC1.csv (52 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.8.csv (48 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.8.NmC1.csv (19 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.8.NmC2.csv (24 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.9.csv (21 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.NmC1.csv (132 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.NmC10.csv (207 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.NmC2.csv (320 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.NmC3.csv (262 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.NmC4.csv (176 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.NmC5.csv (252 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.NmC6.csv (112 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.NmC7.csv (55 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.NmC8.csv (158 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.NmC9.csv (41 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_C.1.csv (87 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_C.1.1.csv (94 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_C.1.1.NmC1.csv (66 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_C.1.NmC1.csv (66 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_C.1.NmC2.csv (32 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_D.1.csv (25 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_E.1.csv (74 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_E.2.csv (63 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_E.3.csv (17 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_F.1.csv (127 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_F.1.NmC1.csv (35 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_F.1.NmC2.csv (79 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_F.2.csv (55 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_F.2.NmC1.csv (41 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_F.2.NmC2.csv (36 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_F.3.csv (78 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_F.4.csv (108 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_F.5.csv (17 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_F.6.csv (32 rows)
INFO: Saving lineage count summary to: samples/monkeypox/dist3size10/samples_total.json
INFO: Sample creation step finished successfully.

2025-07-15 16:30:00,782 - INFO - --- Step Succeeded: /home/topcuoglu/miniconda3/envs/orh/bin/python3 src/05_prepare_recombinhunt/create_samples.py --virus monkeypox --config config/config.yaml ---
2025-07-15 16:30:00,782 - INFO - --- Executing: /home/topcuoglu/miniconda3/envs/orh/bin/python3 src/06_recombinhunt/run_recombinhunt.py --virus monkeypox --config config/config.yaml ---
2025-07-15 16:39:33,101 - INFO - Stdout from step:
INFO: Logging initialized. Log file at: logs/20250715_163001_monkeypox_06_run_recombinhunt.log
INFO: --- Starting Step 6: Run RecombinHunt for 'monkeypox' ---
INFO: Loading RecombinHunt environment from: environments/monkeypox/dist3size10
Starting formal checks of the environment...
INFO: Loading lineage totals from 'samples/monkeypox/dist3size10/samples_total.json'
INFO: Found 90 sample files in 'samples/monkeypox/dist3size10'.
INFO:   Lineage 'A.2.1', Mode 'all': Processing all 16 samples.
INFO:   Lineage 'B.1.20.NmC1', Mode 'all': Processing all 107 samples.
INFO:   Lineage 'B.1.1.NmC1', Mode 'all': Processing all 35 samples.
INFO:   Lineage 'B.1.2', Mode 'all': Processing all 131 samples.
INFO:   Lineage 'B.1.3.NmC2', Mode 'all': Processing all 34 samples.
INFO:   Lineage 'B.1.2.NmC1', Mode 'all': Processing all 56 samples.
INFO:   Lineage 'C.1', Mode 'all': Processing all 87 samples.
INFO:   Lineage 'E.2', Mode 'all': Processing all 63 samples.
INFO:   Lineage 'B.1.12.NmC2', Mode 'all': Processing all 25 samples.
INFO:   Lineage 'C.1.1', Mode 'all': Processing all 94 samples.
INFO:   Lineage 'B.1.9', Mode 'all': Processing all 21 samples.
INFO:   Lineage 'F.2.NmC1', Mode 'all': Processing all 41 samples.
INFO:   Lineage 'F.1.NmC2', Mode 'all': Processing all 79 samples.
INFO:   Lineage 'F.4', Mode 'all': Processing all 108 samples.
INFO:   Lineage 'B.1.5', Mode 'all': Processing all 23 samples.
INFO:   Lineage 'B.1.7', Mode 'all': Processing all 79 samples.
INFO:   Lineage 'B.1.8.NmC2', Mode 'all': Processing all 24 samples.
INFO:   Lineage 'A.2.3', Mode 'all': Processing all 59 samples.
INFO:   Lineage 'B.1.NmC3', Mode 'all': Processing all 262 samples.
INFO:   Lineage 'F.1', Mode 'all': Processing all 127 samples.
INFO:   Lineage 'B.1.16', Mode 'all': Processing all 26 samples.
INFO:   Lineage 'A.1.NmC3', Mode 'all': Processing all 63 samples.
INFO:   Lineage 'B.1.13.NmC1', Mode 'all': Processing all 393 samples.
INFO:   Lineage 'B.1.13', Mode 'all': Processing all 383 samples.
INFO:   Lineage 'B.1.NmC6', Mode 'all': Processing all 112 samples.
INFO:   Lineage 'B.1.17.NmC1', Mode 'all': Processing all 370 samples.
INFO:   Lineage 'A.2.2', Mode 'all': Processing all 113 samples.
INFO:   Lineage 'B.1.NmC7', Mode 'all': Processing all 55 samples.
INFO:   Lineage 'B.1.14', Mode 'all': Processing all 40 samples.
INFO:   Lineage 'B.1.2.NmC2', Mode 'all': Processing all 64 samples.
INFO:   Lineage 'F.2.NmC2', Mode 'all': Processing all 36 samples.
INFO:   Lineage 'A.2', Mode 'all': Processing all 33 samples.
INFO:   Lineage 'B.1.19', Mode 'all': Processing all 15 samples.
INFO:   Lineage 'C.1.1.NmC1', Mode 'all': Processing all 66 samples.
INFO:   Lineage 'B.1.22', Mode 'all': Processing all 39 samples.
INFO:   Lineage 'B.1.17.NmC5', Mode 'all': Processing all 112 samples.
INFO:   Lineage 'B.1.1', Mode 'all': Processing all 400 samples.
INFO:   Lineage 'B.1.17.NmC4', Mode 'all': Processing all 120 samples.
INFO:   Lineage 'B.1.2.NmC3', Mode 'all': Processing all 24 samples.
INFO:   Lineage 'B.1.3.NmC1', Mode 'all': Processing all 57 samples.
INFO:   Lineage 'B.1.NmC10', Mode 'all': Processing all 207 samples.
INFO:   Lineage 'B.1.20', Mode 'all': Processing all 91 samples.
INFO:   Lineage 'F.5', Mode 'all': Processing all 17 samples.
INFO:   Lineage 'B.1.11', Mode 'all': Processing all 68 samples.
INFO:   Lineage 'B.1.17.NmC6', Mode 'all': Processing all 202 samples.
INFO:   Lineage 'B.1.7.NmC1', Mode 'all': Processing all 52 samples.
INFO:   Lineage 'F.2', Mode 'all': Processing all 55 samples.
INFO:   Lineage 'B.1.8.NmC1', Mode 'all': Processing all 19 samples.
INFO:   Lineage 'B.1.15', Mode 'all': Processing all 19 samples.
INFO:   Lineage 'B.1.18', Mode 'all': Processing all 68 samples.
INFO:   Lineage 'B.1.11.NmC1', Mode 'all': Processing all 48 samples.
INFO:   Lineage 'A.1.NmC2', Mode 'all': Processing all 80 samples.
INFO:   Lineage 'B.1', Mode 'all': Processing all 435 samples.
WARNING: Gap made of only target mutations (How can it be? It's an almost impossible condition). Target mutation that minimizes the loss has been assigned to the right region).
INFO:   Lineage 'B.1.10', Mode 'all': Processing all 103 samples.
INFO:   Lineage 'A.3', Mode 'all': Processing all 11 samples.
INFO:   Lineage 'B.1.NmC1', Mode 'all': Processing all 132 samples.
INFO:   Lineage 'F.1.NmC1', Mode 'all': Processing all 35 samples.
INFO:   Lineage 'C.1.NmC2', Mode 'all': Processing all 32 samples.
INFO:   Lineage 'A.1.NmC1', Mode 'all': Processing all 239 samples.
INFO:   Lineage 'B.1.11.NmC2', Mode 'all': Processing all 36 samples.
INFO:   Lineage 'B.1.17.NmC2', Mode 'all': Processing all 180 samples.
INFO:   Lineage 'A.1', Mode 'all': Processing all 16 samples.
INFO:   Lineage 'F.6', Mode 'all': Processing all 32 samples.
INFO:   Lineage 'B.1.2.NmC4', Mode 'all': Processing all 23 samples.
INFO:   Lineage 'B.1.13.NmC3', Mode 'all': Processing all 122 samples.
INFO:   Lineage 'B.1.6', Mode 'all': Processing all 46 samples.
INFO:   Lineage 'D.1', Mode 'all': Processing all 25 samples.
INFO:   Lineage 'B.1.2.NmC6', Mode 'all': Processing all 58 samples.
INFO:   Lineage 'A', Mode 'all': Processing all 66 samples.
ERROR:   Error on one sample in lineage A: No candidates found searching in both directions.
Traceback (most recent call last):
  File "/home/topcuoglu/openrecombinhunt/src/06_recombinhunt/run_recombinhunt.py", line 159, in run_recombinhunt_for_lineage
    result = experiment.run()
  File "/home/topcuoglu/openrecombinhunt/libs/recombinhunt-cov-7.0.0/src/recombinhunt/core/method.py", line 663, in run
    L1_reg: Region = search_L(self.merged_df, self.p_merged_df, self.change_probabilities, min_target_len=self.MIN_CANDIDATE_REGION_LENGTH, cache=self.cache)
  File "/home/topcuoglu/openrecombinhunt/libs/recombinhunt-cov-7.0.0/src/recombinhunt/core/method.py", line 1035, in search_L
    raise NoCandidatesFound("No candidates found searching in both directions.")
recombinhunt.core.method.NoCandidatesFound: No candidates found searching in both directions.
ERROR:   Error on one sample in lineage A: No candidates found searching in both directions.
Traceback (most recent call last):
  File "/home/topcuoglu/openrecombinhunt/src/06_recombinhunt/run_recombinhunt.py", line 159, in run_recombinhunt_for_lineage
    result = experiment.run()
  File "/home/topcuoglu/openrecombinhunt/libs/recombinhunt-cov-7.0.0/src/recombinhunt/core/method.py", line 663, in run
    L1_reg: Region = search_L(self.merged_df, self.p_merged_df, self.change_probabilities, min_target_len=self.MIN_CANDIDATE_REGION_LENGTH, cache=self.cache)
  File "/home/topcuoglu/openrecombinhunt/libs/recombinhunt-cov-7.0.0/src/recombinhunt/core/method.py", line 1035, in search_L
    raise NoCandidatesFound("No candidates found searching in both directions.")
recombinhunt.core.method.NoCandidatesFound: No candidates found searching in both directions.
INFO:   Lineage 'B.1.NmC5', Mode 'all': Processing all 252 samples.
INFO:   Lineage 'B.1.2.NmC5', Mode 'all': Processing all 20 samples.
INFO:   Lineage 'B.1.17', Mode 'all': Processing all 15 samples.
INFO:   Lineage 'B.1.23', Mode 'all': Processing all 11 samples.
INFO:   Lineage 'B.1.22.NmC1', Mode 'all': Processing all 25 samples.
INFO:   Lineage 'B.1.12.NmC1', Mode 'all': Processing all 50 samples.
INFO:   Lineage 'F.3', Mode 'all': Processing all 78 samples.
INFO:   Lineage 'B.1.3', Mode 'all': Processing all 113 samples.
INFO:   Lineage 'B.1.NmC8', Mode 'all': Processing all 158 samples.
INFO:   Lineage 'B.1.17.NmC3', Mode 'all': Processing all 50 samples.
INFO:   Lineage 'C.1.NmC1', Mode 'all': Processing all 66 samples.
INFO:   Lineage 'B.1.NmC9', Mode 'all': Processing all 41 samples.
INFO:   Lineage 'E.3', Mode 'all': Processing all 17 samples.
INFO:   Lineage 'B.1.4', Mode 'all': Processing all 36 samples.
INFO:   Lineage 'E.1', Mode 'all': Processing all 74 samples.
INFO:   Lineage 'B.1.NmC2', Mode 'all': Processing all 320 samples.
WARNING: Gap made of only target mutations (How can it be? It's an almost impossible condition). Target mutation that minimizes the loss has been assigned to the right region).
WARNING: Gap made of only target mutations (How can it be? It's an almost impossible condition). Target mutation that minimizes the loss has been assigned to the right region).
INFO:   Lineage 'B.1.NmC4', Mode 'all': Processing all 176 samples.
WARNING: Gap made of only target mutations (How can it be? It's an almost impossible condition). Target mutation that minimizes the loss has been assigned to the right region).
INFO:   Lineage 'B.1.8', Mode 'all': Processing all 48 samples.
INFO:   Lineage 'B.1.13.NmC2', Mode 'all': Processing all 231 samples.
WARNING: Gap made of only target mutations (How can it be? It's an almost impossible condition). Target mutation that minimizes the loss has been assigned to the right region).
WARNING: Gap made of only target mutations (How can it be? It's an almost impossible condition). Target mutation that minimizes the loss has been assigned to the right region).
INFO:   Lineage 'B.1.21', Mode 'all': Processing all 74 samples.
INFO:   Lineage 'B.1.12', Mode 'all': Processing all 85 samples.
INFO: Text report saved to: results/recombinhunt_output/monkeypox/dist3size10/experiment-output.all.txt
INFO: HTML report saved to: results/recombinhunt_output/monkeypox/dist3size10/experiment-detail.all.html
INFO: RecombinHunt experiment step finished successfully.

2025-07-15 16:39:33,101 - WARNING - Stderr from step:
/home/topcuoglu/openrecombinhunt/libs/recombinhunt-cov-7.0.0/src/recombinhunt/core/environment.py:237: UserWarning: RecombinHunt 5.+ expects a candidates_hierarchy.json in the environment dir but the file is missing. Backward compatibility is possible by calling Environment.embed_candidates_hierarchy() with a CandidatesHierarchy object. Resorting to default CandidatesHierarchy.
  warnings.warn("RecombinHunt 5.+ expects a candidates_hierarchy.json in the environment dir but the file is missing. Backward compatibility is possible by"

Running Experiments:   0%|          | 0/90 [00:00<?, ?it/s]
Running Experiments:   1%|          | 1/90 [00:00<01:08,  1.31it/s]
Running Experiments:   2%|▏         | 2/90 [00:08<07:17,  4.97s/it]
Running Experiments:   3%|▎         | 3/90 [00:10<05:14,  3.61s/it]
Running Experiments:   4%|▍         | 4/90 [00:17<07:13,  5.04s/it]
Running Experiments:   6%|▌         | 5/90 [00:19<05:34,  3.94s/it]
Running Experiments:   7%|▋         | 6/90 [00:23<05:07,  3.66s/it]
Running Experiments:   8%|▊         | 7/90 [00:27<05:33,  4.02s/it]
Running Experiments:   9%|▉         | 8/90 [00:30<05:07,  3.75s/it]
Running Experiments:  10%|█         | 9/90 [00:32<04:03,  3.00s/it]
Running Experiments:  11%|█         | 10/90 [00:37<04:47,  3.59s/it]
Running Experiments:  12%|█▏        | 11/90 [00:38<03:49,  2.91s/it]
Running Experiments:  13%|█▎        | 12/90 [00:41<03:35,  2.77s/it]
Running Experiments:  14%|█▍        | 13/90 [00:46<04:37,  3.60s/it]
Running Experiments:  16%|█▌        | 14/90 [00:52<05:23,  4.25s/it]
Running Experiments:  17%|█▋        | 15/90 [00:53<04:13,  3.38s/it]
Running Experiments:  18%|█▊        | 16/90 [00:58<04:45,  3.85s/it]
Running Experiments:  19%|█▉        | 17/90 [00:59<03:44,  3.08s/it]
Running Experiments:  20%|██        | 18/90 [01:02<03:36,  3.01s/it]
Running Experiments:  21%|██        | 19/90 [01:19<08:24,  7.11s/it]
Running Experiments:  22%|██▏       | 20/90 [01:26<08:27,  7.26s/it]
Running Experiments:  23%|██▎       | 21/90 [01:28<06:15,  5.44s/it]
Running Experiments:  24%|██▍       | 22/90 [01:32<05:45,  5.08s/it]
Running Experiments:  26%|██▌       | 23/90 [01:56<11:53, 10.66s/it]
Running Experiments:  27%|██▋       | 24/90 [02:20<16:18, 14.82s/it]
Running Experiments:  28%|██▊       | 25/90 [02:27<13:23, 12.36s/it]
Running Experiments:  29%|██▉       | 26/90 [02:57<18:55, 17.74s/it]
Running Experiments:  30%|███       | 27/90 [03:02<14:37, 13.93s/it]
Running Experiments:  31%|███       | 28/90 [03:06<11:09, 10.79s/it]
Running Experiments:  32%|███▏      | 29/90 [03:08<08:23,  8.26s/it]
Running Experiments:  33%|███▎      | 30/90 [03:11<06:45,  6.75s/it]
Running Experiments:  34%|███▍      | 31/90 [03:13<05:13,  5.31s/it]
Running Experiments:  36%|███▌      | 32/90 [03:15<04:00,  4.15s/it]
Running Experiments:  37%|███▋      | 33/90 [03:15<03:01,  3.18s/it]
Running Experiments:  38%|███▊      | 34/90 [03:19<02:57,  3.17s/it]
Running Experiments:  39%|███▉      | 35/90 [03:21<02:47,  3.05s/it]
Running Experiments:  40%|████      | 36/90 [03:30<04:17,  4.77s/it]
Running Experiments:  41%|████      | 37/90 [03:59<10:43, 12.14s/it]
Running Experiments:  42%|████▏     | 38/90 [04:11<10:14, 11.82s/it]
Running Experiments:  43%|████▎     | 39/90 [04:12<07:20,  8.64s/it]
Running Experiments:  44%|████▍     | 40/90 [04:15<05:46,  6.92s/it]
Running Experiments:  46%|████▌     | 41/90 [04:29<07:31,  9.21s/it]
Running Experiments:  47%|████▋     | 42/90 [04:36<06:47,  8.50s/it]
Running Experiments:  48%|████▊     | 43/90 [04:37<04:51,  6.20s/it]
Running Experiments:  49%|████▉     | 44/90 [04:41<04:15,  5.54s/it]
Running Experiments:  50%|█████     | 45/90 [04:57<06:25,  8.57s/it]
Running Experiments:  51%|█████     | 46/90 [04:59<05:02,  6.89s/it]
Running Experiments:  52%|█████▏    | 47/90 [05:03<04:13,  5.91s/it]
Running Experiments:  53%|█████▎    | 48/90 [05:04<03:05,  4.42s/it]
Running Experiments:  54%|█████▍    | 49/90 [05:06<02:27,  3.60s/it]
Running Experiments:  56%|█████▌    | 50/90 [05:11<02:39,  4.00s/it]
Running Experiments:  57%|█████▋    | 51/90 [05:14<02:22,  3.66s/it]
Running Experiments:  58%|█████▊    | 52/90 [05:19<02:43,  4.30s/it]
Running Experiments:  59%|█████▉    | 53/90 [05:50<07:33, 12.26s/it]
Running Experiments:  60%|██████    | 54/90 [06:01<07:08, 11.89s/it]
Running Experiments:  61%|██████    | 55/90 [06:02<04:56,  8.48s/it]
Running Experiments:  62%|██████▏   | 56/90 [06:12<05:11,  9.15s/it]
Running Experiments:  63%|██████▎   | 57/90 [06:15<03:57,  7.20s/it]
Running Experiments:  64%|██████▍   | 58/90 [06:17<02:57,  5.55s/it]
Running Experiments:  66%|██████▌   | 59/90 [06:32<04:25,  8.58s/it]
Running Experiments:  67%|██████▋   | 60/90 [06:34<03:17,  6.57s/it]
Running Experiments:  68%|██████▊   | 61/90 [06:50<04:26,  9.20s/it]
Running Experiments:  69%|██████▉   | 62/90 [06:51<03:10,  6.81s/it]
Running Experiments:  70%|███████   | 63/90 [06:53<02:27,  5.48s/it]
Running Experiments:  71%|███████   | 64/90 [06:54<01:49,  4.21s/it]
Running Experiments:  72%|███████▏  | 65/90 [07:06<02:41,  6.45s/it]
Running Experiments:  73%|███████▎  | 66/90 [07:11<02:20,  5.86s/it]
Running Experiments:  74%|███████▍  | 67/90 [07:12<01:46,  4.64s/it]
Running Experiments:  76%|███████▌  | 68/90 [07:16<01:32,  4.21s/it]
Running Experiments:  77%|███████▋  | 69/90 [07:19<01:22,  3.95s/it]
Running Experiments:  78%|███████▊  | 70/90 [07:37<02:40,  8.04s/it]
Running Experiments:  79%|███████▉  | 71/90 [07:38<01:53,  6.00s/it]
Running Experiments:  80%|████████  | 72/90 [07:39<01:22,  4.56s/it]
Running Experiments:  81%|████████  | 73/90 [07:40<00:56,  3.35s/it]
Running Experiments:  82%|████████▏ | 74/90 [07:42<00:47,  2.98s/it]
Running Experiments:  83%|████████▎ | 75/90 [07:44<00:43,  2.90s/it]
Running Experiments:  84%|████████▍ | 76/90 [07:49<00:47,  3.37s/it]
Running Experiments:  86%|████████▌ | 77/90 [07:55<00:55,  4.24s/it]
Running Experiments:  87%|████████▋ | 78/90 [08:10<01:29,  7.46s/it]
Running Experiments:  88%|████████▊ | 79/90 [08:13<01:08,  6.22s/it]
Running Experiments:  89%|████████▉ | 80/90 [08:17<00:54,  5.43s/it]
Running Experiments:  90%|█████████ | 81/90 [08:19<00:40,  4.51s/it]
Running Experiments:  91%|█████████ | 82/90 [08:20<00:27,  3.43s/it]
Running Experiments:  92%|█████████▏| 83/90 [08:23<00:21,  3.14s/it]
Running Experiments:  93%|█████████▎| 84/90 [08:26<00:19,  3.27s/it]
Running Experiments:  94%|█████████▍| 85/90 [08:46<00:40,  8.11s/it]
Running Experiments:  96%|█████████▌| 86/90 [09:03<00:43, 10.91s/it]
Running Experiments:  97%|█████████▋| 87/90 [09:08<00:26,  8.99s/it]
Running Experiments:  98%|█████████▊| 88/90 [09:21<00:20, 10.39s/it]
Running Experiments:  99%|█████████▉| 89/90 [09:26<00:08,  8.63s/it]
Running Experiments: 100%|██████████| 90/90 [09:30<00:00,  7.37s/it]
Running Experiments: 100%|██████████| 90/90 [09:30<00:00,  6.34s/it]

2025-07-15 16:39:33,102 - INFO - --- Step Succeeded: /home/topcuoglu/miniconda3/envs/orh/bin/python3 src/06_recombinhunt/run_recombinhunt.py --virus monkeypox --config config/config.yaml ---
2025-07-15 16:39:33,102 - INFO - ================== PIPELINE FOR MONKEYPOX FINISHED ==================


