2025-07-18 09:02:38,379 - INFO - Logging initialized. Log file at: logs/20250718_090238_sars-cov-2_05.1_create_environment.log
2025-07-18 09:02:38,380 - INFO - Virus is 'sars-cov-2'. Using Nextstrain reformatted as input.
2025-07-18 09:02:39,004 - INFO - Environment files will be saved to: environments/sars-cov-2/dist0size0
2025-07-18 09:02:39,004 - INFO - Loading data from: results/nextstrain_output/sars-cov-2/nextstrain_reformatted.tsv
2025-07-18 09:03:15,060 - INFO - Initial row count: 5,022,174
2025-07-18 09:03:17,501 - INFO - Dropped 270 rows with missing or empty 'mutations' column.
2025-07-18 09:03:17,501 - INFO - Row count after cleaning: 5,021,904
2025-07-18 09:03:17,501 - INFO - Calculating change probabilities...
2025-07-18 09:03:17,501 - INFO -   Total sequences for calculation: 5,021,904
2025-07-18 09:04:16,921 - INFO -   Found 82,050 unique mutations across all sequences.
2025-07-18 09:04:17,047 - INFO -   Finished calculating change probabilities. Shape of result: (82050, 2)
2025-07-18 09:04:21,967 - INFO - Calculating genome and variation counts per lineage...
2025-07-18 09:04:22,213 - INFO -   Found 4,452 unique lineages in the dataset.
2025-07-18 09:13:04,436 - INFO -   Finished calculating genome and variation counts.
2025-07-18 09:13:04,436 - INFO - 
Calculating 'lc_df.parquet'...
2025-07-18 09:13:04,436 - INFO - 
--- Running common logic: calculating lineage mutation frequencies ---
2025-07-18 09:13:04,437 - INFO - Selected 3333 lineages with at least 10 genomes.
2025-07-18 09:13:12,253 - INFO - Removed 0 mutations that were not characteristic of any lineage.
2025-07-18 09:13:12,307 - INFO - lc_df calculation complete.
2025-07-18 09:13:12,327 - INFO - 
Calculating 'change2lineage_probability.parquet'...
2025-07-18 09:13:12,327 - INFO - 
--- Running common logic: calculating lineage mutation frequencies ---
2025-07-18 09:13:12,328 - INFO - Selected 3333 lineages with at least 10 genomes.
2025-07-18 09:14:50,364 - INFO - change2lineage_probability calculation complete.
2025-07-18 09:14:50,364 - INFO - 
Calculating 'lc_quality_df.parquet'...
2025-07-18 09:14:50,369 - INFO - lc_quality_df calculation complete.
2025-07-18 09:14:50,370 - INFO - Saving environment files...
2025-07-18 09:14:51,669 - INFO - Virus is 'sars-cov-2'. Saving two versions of lineage characterisations.
2025-07-18 09:15:07,748 - INFO - Calculating genome and variation counts per lineage...
2025-07-18 09:15:07,975 - INFO -   Found 4,320 unique lineages in the dataset.
2025-07-18 09:23:51,498 - INFO -   Finished calculating genome and variation counts.
2025-07-18 09:23:52,446 - INFO - 
Calculating 'change2lineage_probability.parquet'...
2025-07-18 09:23:52,447 - INFO - 
--- Running common logic: calculating lineage mutation frequencies ---
2025-07-18 09:23:52,448 - INFO - Selected 3233 lineages with at least 10 genomes.
2025-07-18 09:25:27,845 - INFO - change2lineage_probability calculation complete.
2025-07-18 09:25:27,845 - INFO - 
Calculating 'lc_df.parquet'...
2025-07-18 09:25:27,845 - INFO - 
--- Running common logic: calculating lineage mutation frequencies ---
2025-07-18 09:25:27,846 - INFO - Selected 3233 lineages with at least 10 genomes.
2025-07-18 09:25:35,240 - INFO - Removed 0 mutations that were not characteristic of any lineage.
2025-07-18 09:25:35,277 - INFO - lc_df calculation complete.
2025-07-18 09:25:47,594 - INFO - Environment creation complete.
