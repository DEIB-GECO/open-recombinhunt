2025-08-30 15:36:27,337 - INFO - Logging initialized. Log file at: logs/20250830_153627_monkeypox_pipeline_run.log
2025-08-30 15:36:27,337 - INFO - ================== STARTING PIPELINE FOR: MONKEYPOX ==================
2025-08-30 15:36:27,337 - INFO - --- Executing: /home/topcuoglu/miniconda3/envs/orh/bin/python src/01_data_acquisition/fetch_data.py --virus monkeypox --config config/config.yaml ---
2025-08-30 15:39:16,541 - INFO - Stdout from step:
INFO: Logging initialized. Log file at: logs/20250830_153627_monkeypox_01_fetch_data.log
INFO: Ensuring raw data directory exists: data/raw/monkeypox
INFO: Starting NCBI data acquisition via CLI...
INFO: Step 1: Downloading main dataset...
INFO: Executing: datasets download virus genome taxon 10244 --include genome --filename monkeypox-download.zip
INFO: Unzipping data/raw/monkeypox/temp_complete_download/monkeypox-download.zip...
INFO: Executing: dataformat tsv virus-genome --inputfile ncbi_dataset/data/data_report.jsonl > monkeypox-raw-metadata.tsv
INFO: Found: data/raw/monkeypox/temp_complete_download/ncbi_dataset/data/genomic.fna. Moving and renaming to data/raw/monkeypox/raw_sequences.fasta
INFO: Found: data/raw/monkeypox/temp_complete_download/monkeypox-raw-metadata.tsv. Moving and renaming to data/raw/monkeypox/raw_metadata.tsv
INFO: Step 3: Cleaning up temporary files...
INFO: Cleanup complete.
INFO: Step 2: Downloading reference sequence...
INFO: Fetching reference sequence from NCBI...
INFO: Executing: datasets download virus genome accession NC_063383.1 --include genome --filename monkeypox-reference.zip
INFO: Unzipping data/raw/monkeypox/temp_ref_download/monkeypox-reference.zip...
INFO: Found: data/raw/monkeypox/temp_ref_download/ncbi_dataset/data/genomic.fna. Moving and renaming to data/raw/monkeypox/reference.fasta
INFO: Cleaning up temporary reference sequence files...
INFO: Data fetching process for 'monkeypox' complete.

2025-08-30 15:39:16,541 - INFO - --- Step Succeeded: /home/topcuoglu/miniconda3/envs/orh/bin/python src/01_data_acquisition/fetch_data.py --virus monkeypox --config config/config.yaml ---
2025-08-30 15:39:16,541 - INFO - --- Executing: /home/topcuoglu/miniconda3/envs/orh/bin/python src/02_preprocessing/ncbi/prep_metadata_ncbi.py --virus monkeypox --config config/config.yaml ---
2025-08-30 15:39:17,538 - INFO - Stdout from step:
INFO: Logging initialized. Log file at: logs/20250830_153917_monkeypox_02.1_prep_metadata_ncbi.log
INFO: Loading raw metadata from data/raw/monkeypox/raw_metadata.tsv...
INFO: Step 1: Applying quality filters from config and checking for special characters in ID...
INFO:   Filter 'Isolate Collection date notna None': Removed 477 rows.
INFO:   Filter 'Accession notna None': Removed 0 rows.
INFO:   Filter 'Length notna None': Removed 0 rows.
INFO:   Filter 'Length >= 177488': Removed 280 rows.
INFO:   Filter 'Special Chars in ID': Removed 0 rows.
INFO: Step 2: Processing lineage column...
INFO: Using source column 'Virus Pangolin Classification' for lineage information.
INFO:   Identified and removed 1416 non-classified rows (missing 'Virus Pangolin Classification').
INFO: Step 3: Performing final formatting on date and location columns...
INFO: Formatting date columns...
INFO:   - Analyzing and formatting 'Collection date'
INFO:     Date format statistics for 'Collection date':
INFO:       YYYY-MM-DD format: 4341
INFO:       YYYY-MM format   : 3970
INFO:       YYYY format      : 273
INFO:       Other/unparseable: 0
INFO:       Missing (NA)     : 0
INFO:   - Analyzing and formatting 'Submission date'
INFO:     Date format statistics for 'Submission date':
INFO:       YYYY-MM-DD format: 0
INFO:       YYYY-MM format   : 0
INFO:       YYYY format      : 0
INFO:       Other/unparseable: 8584
INFO:       Missing (NA)     : 0
INFO: Formatting 'Location' column by combining 'Geographic Region' and 'Geographic Location'...
INFO: Preprocessing complete. Final dataset has 8584 rows.
INFO: Saving processed metadata (8584 rows) to data/processed/monkeypox/metadata.tsv...
INFO: Saving 757 quality-filtered sequence IDs to data/processed/monkeypox/filtered_sequence_ids.txt...
INFO: Saving 1416 non-classified sequence IDs to data/processed/monkeypox/non_classified_sequence_ids.txt...
INFO: Script finished successfully.

2025-08-30 15:39:17,538 - INFO - --- Step Succeeded: /home/topcuoglu/miniconda3/envs/orh/bin/python src/02_preprocessing/ncbi/prep_metadata_ncbi.py --virus monkeypox --config config/config.yaml ---
2025-08-30 15:39:17,538 - INFO - --- Executing: /home/topcuoglu/miniconda3/envs/orh/bin/python src/02_preprocessing/common/prep_fasta.py --virus monkeypox --config config/config.yaml ---
2025-08-30 15:39:40,174 - INFO - Stdout from step:
INFO: Logging initialized. Log file at: logs/20250830_153917_monkeypox_02.2_prep_fasta.log
INFO: Loading IDs of sequences to be dropped...
INFO: Loading IDs from: data/processed/monkeypox/filtered_sequence_ids.txt
INFO: Loaded 757 unique IDs.
INFO: Loading IDs from: data/processed/monkeypox/non_classified_sequence_ids.txt
INFO: Loaded 1416 unique IDs.
INFO: NUmber of Filtered IDs: 757
INFO: Number of Non-Classified IDs: 1416
INFO: Total unique IDs to drop from FASTA file: 2173
INFO: Filtering FASTA file: data/raw/monkeypox/raw_sequences.fasta...
INFO: Removing sequences whose ID is in the combined dropped list (2173 total IDs).
INFO: FASTA Filtering Summary:
INFO:   Original sequences read: 10757
INFO:   Sequences dropped      : 2173
INFO:   Sequences kept         : 8584
INFO: Filtered FASTA saved to  : data/processed/monkeypox/sequences.fasta
INFO: Script finished successfully.

2025-08-30 15:39:40,174 - INFO - --- Step Succeeded: /home/topcuoglu/miniconda3/envs/orh/bin/python src/02_preprocessing/common/prep_fasta.py --virus monkeypox --config config/config.yaml ---
2025-08-30 15:39:40,175 - INFO - --- Executing: /home/topcuoglu/miniconda3/envs/orh/bin/python src/02_preprocessing/common/prep_ref.py --virus monkeypox --config config/config.yaml ---
2025-08-30 15:39:40,287 - INFO - Stdout from step:
INFO: Logging initialized. Log file at: logs/20250830_153940_monkeypox_02.3_prep_ref.log
INFO: Copying reference sequence...
INFO:   Source: data/raw/monkeypox/reference.fasta
INFO:   Destination: data/processed/monkeypox/reference.fasta
INFO: Reference sequence successfully copied to processed directory.
INFO: Script finished successfully.

2025-08-30 15:39:40,288 - INFO - --- Step Succeeded: /home/topcuoglu/miniconda3/envs/orh/bin/python src/02_preprocessing/common/prep_ref.py --virus monkeypox --config config/config.yaml ---
2025-08-30 15:39:40,288 - INFO - --- Executing: /home/topcuoglu/miniconda3/envs/orh/bin/python src/03_haplocov/run_haplocov.py --virus monkeypox --config config/config.yaml ---
2025-08-30 15:54:14,575 - INFO - Stdout from step:
INFO: Logging initialized. Log file at: logs/20250830_153940_monkeypox_03_run_haplocov.log
INFO: --- Starting Step 3: Run HaploCoV for 'monkeypox' ---
INFO: Created temporary working directory: results/haplocov_output/monkeypox/dist3size10/temp_work
INFO: Creating symbolic links for input files in temporary directory...
INFO: Executing HaploCoV with designation_mode: 'both'
INFO: Executing: perl ../../../../../libs/haplocov/addToTableNCBI.pl --metadata metadata.tsv --ref reference.fasta --seq sequences.fasta --outfile out.HaploCoV --nproc 16
INFO: Executing: perl ../../../../../libs/haplocov/computeDefining.pl out.HaploCoV
INFO: Executing: perl ../../../../../libs/haplocov/assign.pl --dfile out.HaploCoV.definingVariants.txt --infile out.HaploCoV --outfile out.HaploCoV.assigned
INFO: Executing: perl ../../../../../libs/haplocov/augmentClusters.pl --metafile out.HaploCoV.assigned --deffile out.HaploCoV.definingVariants.txt --posFile out.HaploCoV.frequentVariants.txt --outfile out.HaploCoV.definingVariantsNew.txt --dist 3 --size 10
INFO: Executing: perl ../../../../../libs/haplocov/assign.pl --dfile out.HaploCoV.definingVariantsNew.txt --infile out.HaploCoV --outfile out.HaploCoV.assignedNew
INFO: Executing: cut -f 10 out.HaploCoV.assignedNew | sort | uniq -c > monkeypox-report.txt
INFO: Moving final output file 'out.HaploCoV.assignedNew' to 'results/haplocov_output/monkeypox/dist3size10/haplocov_assigned.tsv'
INFO: HaploCoV step completed.
INFO: HaploCoV step finished successfully.

2025-08-30 15:54:14,576 - INFO - --- Step Succeeded: /home/topcuoglu/miniconda3/envs/orh/bin/python src/03_haplocov/run_haplocov.py --virus monkeypox --config config/config.yaml ---
2025-08-30 15:54:14,577 - INFO - --- Executing: /home/topcuoglu/miniconda3/envs/orh/bin/python src/04_postprocessing/format_haplocov_variations.py --virus monkeypox --config config/config.yaml ---
2025-08-30 15:54:15,720 - INFO - Stdout from step:
INFO: Logging initialized. Log file at: logs/20250830_155415_monkeypox_04_postprocess_haplocov.log
INFO: Loading HaploCoV output from: results/haplocov_output/monkeypox/dist3size10/haplocov_assigned.tsv
INFO: Reformatting mutations in the 'listV' column...
INFO: Saving reformatted data to: results/haplocov_output/monkeypox/dist3size10/haplocov_reformatted.tsv
INFO: Script finished successfully.

2025-08-30 15:54:15,721 - WARNING - Stderr from step:

Formatting mutations:   0%|          | 0/8584 [00:00<?, ?it/s]
Formatting mutations:  47%|████▋     | 4021/8584 [00:00<00:00, 40200.26it/s]
Formatting mutations:  94%|█████████▎| 8042/8584 [00:00<00:00, 38835.26it/s]
Formatting mutations: 100%|██████████| 8584/8584 [00:00<00:00, 38029.75it/s]

2025-08-30 15:54:15,721 - INFO - --- Step Succeeded: /home/topcuoglu/miniconda3/envs/orh/bin/python src/04_postprocessing/format_haplocov_variations.py --virus monkeypox --config config/config.yaml ---
2025-08-30 15:54:15,721 - INFO - --- Executing: /home/topcuoglu/miniconda3/envs/orh/bin/python src/05_prepare_recombinhunt/create_environment.py --virus monkeypox --config config/config.yaml ---
2025-08-30 15:54:17,939 - INFO - Stdout from step:
INFO: Logging initialized. Log file at: logs/20250830_155416_monkeypox_05.1_create_environment.log
INFO: Virus is 'monkeypox'. Using HaploCoV reformatted output as input.
INFO: Environment files will be saved to: environments/monkeypox/dist3size10
INFO: Loading data from: results/haplocov_output/monkeypox/dist3size10/haplocov_reformatted.tsv
INFO: Initial row count: 8,584
INFO: Dropped 1 rows with missing or empty 'mutations' column.
INFO: Row count after cleaning: 8,583
INFO: Calculating change probabilities...
INFO:   Total sequences for calculation: 8,583
INFO:   Found 9,414 unique mutations across all sequences.
INFO:   Finished calculating change probabilities. Shape of result: (9414, 2)
INFO: Calculating genome and variation counts per lineage...
INFO:   Found 90 unique lineages in the dataset.
INFO:   Finished calculating genome and variation counts.
INFO: 
Calculating 'lc_df.parquet'...
INFO: 
--- Running common logic: calculating lineage mutation frequencies ---
INFO: Selected 90 lineages with at least 10 genomes.
INFO: Removed 0 mutations that were not characteristic of any lineage.
INFO: lc_df calculation complete.
INFO: 
Calculating 'change2lineage_probability.parquet'...
INFO: 
--- Running common logic: calculating lineage mutation frequencies ---
INFO: Selected 90 lineages with at least 10 genomes.
INFO: change2lineage_probability calculation complete.
INFO: 
Calculating 'lc_quality_df.parquet'...
INFO: lc_quality_df calculation complete.
INFO: Saving environment files...
INFO: Environment creation complete.

2025-08-30 15:54:17,940 - INFO - --- Step Succeeded: /home/topcuoglu/miniconda3/envs/orh/bin/python src/05_prepare_recombinhunt/create_environment.py --virus monkeypox --config config/config.yaml ---
2025-08-30 15:54:17,940 - INFO - --- Executing: /home/topcuoglu/miniconda3/envs/orh/bin/python src/05_prepare_recombinhunt/create_samples.py --virus monkeypox --config config/config.yaml ---
2025-08-30 15:54:18,951 - INFO - Stdout from step:
INFO: Logging initialized. Log file at: logs/20250830_155418_monkeypox_05.2_create_samples.log
INFO: --- Starting Step 5.2: Create Samples for 'monkeypox' ---
INFO: Virus is 'monkeypox'. Using HaploCoV reformatted output as input.
INFO: Sample files will be saved to: samples/monkeypox/dist3size10
INFO: Loading data from: results/haplocov_output/monkeypox/dist3size10/haplocov_reformatted.tsv
INFO: Cleaning data by dropping rows with missing pangoLin or mutations...
WARNING: Found 1 sequences with missing 'mutations'. They will be dropped.
WARNING:   Dropped IDs (missing mutations): ['NC_063383.1']
INFO: Initially, there were 8584 rows.
INFO: Data cleaning complete. 8583 rows remaining for sample creation.
INFO: Grouping by lineage and creating sample files...
INFO:   Saved: samples/monkeypox/dist3size10/samples_A.csv (58 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_A.1.csv (16 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_A.1.NmC1.csv (241 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_A.1.NmC2.csv (82 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_A.1.NmC3.csv (63 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_A.2.csv (62 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_A.2.1.csv (17 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_A.2.2.csv (140 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_A.2.3.csv (60 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_A.3.csv (11 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.csv (452 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.1.csv (446 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.1.NmC1.csv (35 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.10.csv (103 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.11.csv (72 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.11.NmC1.csv (47 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.11.NmC2.csv (36 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.12.csv (86 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.12.NmC1.csv (50 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.12.NmC2.csv (25 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.13.csv (353 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.13.NmC1.csv (402 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.13.NmC2.csv (242 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.13.NmC3.csv (123 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.14.csv (40 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.15.csv (19 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.16.csv (26 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.17.csv (15 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.17.NmC1.csv (375 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.17.NmC2.csv (182 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.17.NmC3.csv (53 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.17.NmC4.csv (116 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.17.NmC5.csv (119 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.17.NmC6.csv (201 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.18.csv (68 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.19.csv (13 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.2.csv (132 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.2.NmC1.csv (56 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.2.NmC2.csv (63 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.2.NmC3.csv (26 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.2.NmC4.csv (23 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.2.NmC5.csv (21 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.2.NmC6.csv (61 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.20.csv (87 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.20.NmC1.csv (92 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.21.csv (75 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.22.csv (36 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.22.NmC1.csv (23 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.23.csv (11 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.3.csv (115 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.3.NmC1.csv (58 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.3.NmC2.csv (37 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.4.csv (29 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.5.csv (25 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.6.csv (35 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.7.csv (59 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.7.NmC1.csv (49 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.8.csv (49 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.8.NmC1.csv (21 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.8.NmC2.csv (24 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.9.csv (21 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.NmC1.csv (132 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.NmC10.csv (223 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.NmC2.csv (322 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.NmC3.csv (263 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.NmC4.csv (180 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.NmC5.csv (256 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.NmC6.csv (113 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.NmC7.csv (172 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.NmC8.csv (55 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_B.1.NmC9.csv (44 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_C.1.csv (87 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_C.1.1.csv (90 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_C.1.1.NmC1.csv (65 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_C.1.NmC1.csv (66 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_C.1.NmC2.csv (32 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_D.1.csv (25 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_E.1.csv (76 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_E.2.csv (69 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_E.3.csv (17 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_F.1.csv (127 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_F.1.NmC1.csv (79 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_F.1.NmC2.csv (27 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_F.2.csv (70 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_F.2.NmC1.csv (41 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_F.2.NmC2.csv (36 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_F.3.csv (76 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_F.4.csv (113 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_F.5.csv (17 rows)
INFO:   Saved: samples/monkeypox/dist3size10/samples_F.6.csv (33 rows)
INFO: Saving lineage count summary to: samples/monkeypox/dist3size10/samples_total.json
INFO: Sample creation step finished successfully.

2025-08-30 15:54:18,951 - INFO - --- Step Succeeded: /home/topcuoglu/miniconda3/envs/orh/bin/python src/05_prepare_recombinhunt/create_samples.py --virus monkeypox --config config/config.yaml ---
2025-08-30 15:54:18,951 - INFO - --- Executing: /home/topcuoglu/miniconda3/envs/orh/bin/python src/06_recombinhunt/run_recombinhunt.py --virus monkeypox --config config/config.yaml ---
2025-08-30 16:04:05,576 - INFO - Stdout from step:
INFO: Logging initialized. Log file at: logs/20250830_155420_monkeypox_06_run_recombinhunt.log
INFO: --- Starting Step 6: Run RecombinHunt for 'monkeypox' ---
INFO: Loading RecombinHunt environment from: environments/monkeypox/dist3size10
Starting formal checks of the environment...
INFO: Loading lineage totals from 'samples/monkeypox/dist3size10/samples_total.json'
INFO: Found 90 sample files in 'samples/monkeypox/dist3size10'.
INFO:   Lineage 'A.2.1', Mode 'all': Processing all 17 samples.
INFO:   Lineage 'B.1.20.NmC1', Mode 'all': Processing all 92 samples.
INFO:   Lineage 'B.1.1.NmC1', Mode 'all': Processing all 35 samples.
INFO:   Lineage 'B.1.2', Mode 'all': Processing all 132 samples.
INFO:   Lineage 'B.1.3.NmC2', Mode 'all': Processing all 37 samples.
INFO:   Lineage 'B.1.2.NmC1', Mode 'all': Processing all 56 samples.
INFO:   Lineage 'C.1', Mode 'all': Processing all 87 samples.
INFO:   Lineage 'E.2', Mode 'all': Processing all 69 samples.
INFO:   Lineage 'B.1.12.NmC2', Mode 'all': Processing all 25 samples.
INFO:   Lineage 'C.1.1', Mode 'all': Processing all 90 samples.
INFO:   Lineage 'B.1.9', Mode 'all': Processing all 21 samples.
INFO:   Lineage 'F.2.NmC1', Mode 'all': Processing all 41 samples.
INFO:   Lineage 'F.1.NmC2', Mode 'all': Processing all 27 samples.
INFO:   Lineage 'F.4', Mode 'all': Processing all 113 samples.
INFO:   Lineage 'B.1.5', Mode 'all': Processing all 25 samples.
INFO:   Lineage 'B.1.7', Mode 'all': Processing all 59 samples.
INFO:   Lineage 'B.1.8.NmC2', Mode 'all': Processing all 24 samples.
INFO:   Lineage 'A.2.3', Mode 'all': Processing all 60 samples.
INFO:   Lineage 'B.1.NmC3', Mode 'all': Processing all 263 samples.
INFO:   Lineage 'F.1', Mode 'all': Processing all 127 samples.
INFO:   Lineage 'B.1.16', Mode 'all': Processing all 26 samples.
INFO:   Lineage 'A.1.NmC3', Mode 'all': Processing all 63 samples.
INFO:   Lineage 'B.1.13.NmC1', Mode 'all': Processing all 402 samples.
INFO:   Lineage 'B.1.13', Mode 'all': Processing all 353 samples.
INFO:   Lineage 'B.1.NmC6', Mode 'all': Processing all 113 samples.
INFO:   Lineage 'B.1.17.NmC1', Mode 'all': Processing all 375 samples.
INFO:   Lineage 'A.2.2', Mode 'all': Processing all 140 samples.
INFO:   Lineage 'B.1.NmC7', Mode 'all': Processing all 172 samples.
INFO:   Lineage 'B.1.14', Mode 'all': Processing all 40 samples.
INFO:   Lineage 'B.1.2.NmC2', Mode 'all': Processing all 63 samples.
INFO:   Lineage 'F.2.NmC2', Mode 'all': Processing all 36 samples.
INFO:   Lineage 'A.2', Mode 'all': Processing all 62 samples.
INFO:   Lineage 'B.1.19', Mode 'all': Processing all 13 samples.
INFO:   Lineage 'C.1.1.NmC1', Mode 'all': Processing all 65 samples.
INFO:   Lineage 'B.1.22', Mode 'all': Processing all 36 samples.
INFO:   Lineage 'B.1.17.NmC5', Mode 'all': Processing all 119 samples.
INFO:   Lineage 'B.1.1', Mode 'all': Processing all 446 samples.
WARNING: Gap made of only target mutations (How can it be? It's an almost impossible condition). Target mutation that minimizes the loss has been assigned to the right region).
INFO:   Lineage 'B.1.17.NmC4', Mode 'all': Processing all 116 samples.
INFO:   Lineage 'B.1.2.NmC3', Mode 'all': Processing all 26 samples.
INFO:   Lineage 'B.1.3.NmC1', Mode 'all': Processing all 58 samples.
INFO:   Lineage 'B.1.NmC10', Mode 'all': Processing all 223 samples.
INFO:   Lineage 'B.1.20', Mode 'all': Processing all 87 samples.
INFO:   Lineage 'F.5', Mode 'all': Processing all 17 samples.
INFO:   Lineage 'B.1.11', Mode 'all': Processing all 72 samples.
INFO:   Lineage 'B.1.17.NmC6', Mode 'all': Processing all 201 samples.
INFO:   Lineage 'B.1.7.NmC1', Mode 'all': Processing all 49 samples.
INFO:   Lineage 'F.2', Mode 'all': Processing all 70 samples.
INFO:   Lineage 'B.1.8.NmC1', Mode 'all': Processing all 21 samples.
INFO:   Lineage 'B.1.15', Mode 'all': Processing all 19 samples.
INFO:   Lineage 'B.1.18', Mode 'all': Processing all 68 samples.
INFO:   Lineage 'B.1.11.NmC1', Mode 'all': Processing all 47 samples.
INFO:   Lineage 'A.1.NmC2', Mode 'all': Processing all 82 samples.
INFO:   Lineage 'B.1', Mode 'all': Processing all 452 samples.
WARNING: Gap made of only target mutations (How can it be? It's an almost impossible condition). Target mutation that minimizes the loss has been assigned to the right region).
INFO:   Lineage 'B.1.10', Mode 'all': Processing all 103 samples.
INFO:   Lineage 'A.3', Mode 'all': Processing all 11 samples.
INFO:   Lineage 'B.1.NmC1', Mode 'all': Processing all 132 samples.
INFO:   Lineage 'F.1.NmC1', Mode 'all': Processing all 79 samples.
INFO:   Lineage 'C.1.NmC2', Mode 'all': Processing all 32 samples.
INFO:   Lineage 'A.1.NmC1', Mode 'all': Processing all 241 samples.
INFO:   Lineage 'B.1.11.NmC2', Mode 'all': Processing all 36 samples.
INFO:   Lineage 'B.1.17.NmC2', Mode 'all': Processing all 182 samples.
INFO:   Lineage 'A.1', Mode 'all': Processing all 16 samples.
INFO:   Lineage 'F.6', Mode 'all': Processing all 33 samples.
INFO:   Lineage 'B.1.2.NmC4', Mode 'all': Processing all 23 samples.
INFO:   Lineage 'B.1.13.NmC3', Mode 'all': Processing all 123 samples.
INFO:   Lineage 'B.1.6', Mode 'all': Processing all 35 samples.
INFO:   Lineage 'D.1', Mode 'all': Processing all 25 samples.
INFO:   Lineage 'B.1.2.NmC6', Mode 'all': Processing all 61 samples.
INFO:   Lineage 'A', Mode 'all': Processing all 58 samples.
ERROR:   Error on one sample in lineage A: No candidates found searching in both directions.
Traceback (most recent call last):
  File "/home/topcuoglu/openrecombinhunt/src/06_recombinhunt/run_recombinhunt.py", line 163, in run_recombinhunt_for_lineage
    result = experiment.run()
  File "/home/topcuoglu/openrecombinhunt/libs/recombinhunt-cov-7.0.0/src/recombinhunt/core/method.py", line 663, in run
    L1_reg: Region = search_L(self.merged_df, self.p_merged_df, self.change_probabilities, min_target_len=self.MIN_CANDIDATE_REGION_LENGTH, cache=self.cache)
  File "/home/topcuoglu/openrecombinhunt/libs/recombinhunt-cov-7.0.0/src/recombinhunt/core/method.py", line 1035, in search_L
    raise NoCandidatesFound("No candidates found searching in both directions.")
recombinhunt.core.method.NoCandidatesFound: No candidates found searching in both directions.
ERROR:   Error on one sample in lineage A: No candidates found searching in both directions.
Traceback (most recent call last):
  File "/home/topcuoglu/openrecombinhunt/src/06_recombinhunt/run_recombinhunt.py", line 163, in run_recombinhunt_for_lineage
    result = experiment.run()
  File "/home/topcuoglu/openrecombinhunt/libs/recombinhunt-cov-7.0.0/src/recombinhunt/core/method.py", line 663, in run
    L1_reg: Region = search_L(self.merged_df, self.p_merged_df, self.change_probabilities, min_target_len=self.MIN_CANDIDATE_REGION_LENGTH, cache=self.cache)
  File "/home/topcuoglu/openrecombinhunt/libs/recombinhunt-cov-7.0.0/src/recombinhunt/core/method.py", line 1035, in search_L
    raise NoCandidatesFound("No candidates found searching in both directions.")
recombinhunt.core.method.NoCandidatesFound: No candidates found searching in both directions.
INFO:   Lineage 'B.1.NmC5', Mode 'all': Processing all 256 samples.
INFO:   Lineage 'B.1.2.NmC5', Mode 'all': Processing all 21 samples.
INFO:   Lineage 'B.1.17', Mode 'all': Processing all 15 samples.
INFO:   Lineage 'B.1.23', Mode 'all': Processing all 11 samples.
INFO:   Lineage 'B.1.22.NmC1', Mode 'all': Processing all 23 samples.
INFO:   Lineage 'B.1.12.NmC1', Mode 'all': Processing all 50 samples.
INFO:   Lineage 'F.3', Mode 'all': Processing all 76 samples.
INFO:   Lineage 'B.1.3', Mode 'all': Processing all 115 samples.
INFO:   Lineage 'B.1.NmC8', Mode 'all': Processing all 55 samples.
INFO:   Lineage 'B.1.17.NmC3', Mode 'all': Processing all 53 samples.
INFO:   Lineage 'C.1.NmC1', Mode 'all': Processing all 66 samples.
INFO:   Lineage 'B.1.NmC9', Mode 'all': Processing all 44 samples.
INFO:   Lineage 'E.3', Mode 'all': Processing all 17 samples.
INFO:   Lineage 'B.1.4', Mode 'all': Processing all 29 samples.
INFO:   Lineage 'E.1', Mode 'all': Processing all 76 samples.
INFO:   Lineage 'B.1.NmC2', Mode 'all': Processing all 322 samples.
WARNING: Gap made of only target mutations (How can it be? It's an almost impossible condition). Target mutation that minimizes the loss has been assigned to the right region).
INFO:   Lineage 'B.1.NmC4', Mode 'all': Processing all 180 samples.
WARNING: Gap made of only target mutations (How can it be? It's an almost impossible condition). Target mutation that minimizes the loss has been assigned to the right region).
INFO:   Lineage 'B.1.8', Mode 'all': Processing all 49 samples.
INFO:   Lineage 'B.1.13.NmC2', Mode 'all': Processing all 242 samples.
WARNING: Gap made of only target mutations (How can it be? It's an almost impossible condition). Target mutation that minimizes the loss has been assigned to the right region).
WARNING: Gap made of only target mutations (How can it be? It's an almost impossible condition). Target mutation that minimizes the loss has been assigned to the right region).
INFO:   Lineage 'B.1.21', Mode 'all': Processing all 75 samples.
INFO:   Lineage 'B.1.12', Mode 'all': Processing all 86 samples.
INFO: Recombinant summary saved to: results/recombinhunt_output/monkeypox/dist3size10/recombinant_summary.tsv
INFO: Saved extensive summary table to: results/recombinhunt_output/monkeypox/dist3size10/recombinant_summary_extensive.tsv
INFO: Text report saved to: results/recombinhunt_output/monkeypox/dist3size10/experiment-output.all.txt
INFO: HTML report saved to: results/recombinhunt_output/monkeypox/dist3size10/experiment-detail.all.html
INFO: RecombinHunt experiment step finished successfully.

2025-08-30 16:04:05,577 - WARNING - Stderr from step:
/home/topcuoglu/openrecombinhunt/libs/recombinhunt-cov-7.0.0/src/recombinhunt/core/environment.py:237: UserWarning: RecombinHunt 5.+ expects a candidates_hierarchy.json in the environment dir but the file is missing. Backward compatibility is possible by calling Environment.embed_candidates_hierarchy() with a CandidatesHierarchy object. Resorting to default CandidatesHierarchy.
  warnings.warn("RecombinHunt 5.+ expects a candidates_hierarchy.json in the environment dir but the file is missing. Backward compatibility is possible by"

Running Experiments:   0%|          | 0/90 [00:00<?, ?it/s]
Running Experiments:   1%|          | 1/90 [00:00<01:08,  1.29it/s]
Running Experiments:   2%|▏         | 2/90 [00:05<04:54,  3.35s/it]
Running Experiments:   3%|▎         | 3/90 [00:07<03:53,  2.68s/it]
Running Experiments:   4%|▍         | 4/90 [00:14<06:15,  4.37s/it]
Running Experiments:   6%|▌         | 5/90 [00:17<05:06,  3.61s/it]
Running Experiments:   7%|▋         | 6/90 [00:19<04:43,  3.38s/it]
Running Experiments:   8%|▊         | 7/90 [00:24<05:03,  3.66s/it]
Running Experiments:   9%|▉         | 8/90 [00:27<04:52,  3.56s/it]
Running Experiments:  10%|█         | 9/90 [00:28<03:50,  2.85s/it]
Running Experiments:  11%|█         | 10/90 [00:33<04:28,  3.36s/it]
Running Experiments:  12%|█▏        | 11/90 [00:34<03:35,  2.73s/it]
Running Experiments:  13%|█▎        | 12/90 [00:36<03:22,  2.60s/it]
Running Experiments:  14%|█▍        | 13/90 [00:38<03:00,  2.34s/it]
Running Experiments:  16%|█▌        | 14/90 [00:44<04:11,  3.31s/it]
Running Experiments:  17%|█▋        | 15/90 [00:45<03:24,  2.72s/it]
Running Experiments:  18%|█▊        | 16/90 [00:48<03:28,  2.81s/it]
Running Experiments:  19%|█▉        | 17/90 [00:49<02:49,  2.32s/it]
Running Experiments:  20%|██        | 18/90 [00:52<02:55,  2.44s/it]
Running Experiments:  21%|██        | 19/90 [01:08<07:42,  6.51s/it]
Running Experiments:  22%|██▏       | 20/90 [01:16<08:00,  6.86s/it]
Running Experiments:  23%|██▎       | 21/90 [01:17<05:57,  5.18s/it]
Running Experiments:  24%|██▍       | 22/90 [01:22<05:39,  5.00s/it]
Running Experiments:  26%|██▌       | 23/90 [01:46<12:03, 10.81s/it]
Running Experiments:  27%|██▋       | 24/90 [02:08<15:43, 14.29s/it]
Running Experiments:  28%|██▊       | 25/90 [02:15<12:55, 11.93s/it]
Running Experiments:  29%|██▉       | 26/90 [02:45<18:40, 17.50s/it]
Running Experiments:  30%|███       | 27/90 [02:52<14:51, 14.15s/it]
Running Experiments:  31%|███       | 28/90 [03:10<15:56, 15.44s/it]
Running Experiments:  32%|███▏      | 29/90 [03:12<11:42, 11.52s/it]
Running Experiments:  33%|███▎      | 30/90 [03:16<09:02,  9.04s/it]
Running Experiments:  34%|███▍      | 31/90 [03:18<06:47,  6.90s/it]
Running Experiments:  36%|███▌      | 32/90 [03:20<05:28,  5.67s/it]
Running Experiments:  37%|███▋      | 33/90 [03:21<03:59,  4.20s/it]
Running Experiments:  38%|███▊      | 34/90 [03:24<03:38,  3.89s/it]
Running Experiments:  39%|███▉      | 35/90 [03:27<03:12,  3.50s/it]
Running Experiments:  40%|████      | 36/90 [03:39<05:23,  6.00s/it]
Running Experiments:  41%|████      | 37/90 [04:13<12:42, 14.38s/it]
Running Experiments:  42%|████▏     | 38/90 [04:25<11:49, 13.65s/it]
Running Experiments:  43%|████▎     | 39/90 [04:26<08:27,  9.95s/it]
Running Experiments:  44%|████▍     | 40/90 [04:29<06:33,  7.87s/it]
Running Experiments:  46%|████▌     | 41/90 [04:45<08:28, 10.38s/it]
Running Experiments:  47%|████▋     | 42/90 [04:51<07:17,  9.11s/it]
Running Experiments:  48%|████▊     | 43/90 [04:52<05:11,  6.63s/it]
Running Experiments:  49%|████▉     | 44/90 [04:56<04:33,  5.95s/it]
Running Experiments:  50%|█████     | 45/90 [05:13<06:49,  9.09s/it]
Running Experiments:  51%|█████     | 46/90 [05:16<05:17,  7.21s/it]
Running Experiments:  52%|█████▏    | 47/90 [05:20<04:34,  6.38s/it]
Running Experiments:  53%|█████▎    | 48/90 [05:21<03:22,  4.81s/it]
Running Experiments:  54%|█████▍    | 49/90 [05:23<02:40,  3.92s/it]
Running Experiments:  56%|█████▌    | 50/90 [05:28<02:49,  4.24s/it]
Running Experiments:  57%|█████▋    | 51/90 [05:31<02:29,  3.83s/it]
Running Experiments:  58%|█████▊    | 52/90 [05:37<02:46,  4.38s/it]
Running Experiments:  59%|█████▉    | 53/90 [06:10<08:02, 13.05s/it]
Running Experiments:  60%|██████    | 54/90 [06:22<07:39, 12.75s/it]
Running Experiments:  61%|██████    | 55/90 [06:23<05:17,  9.08s/it]
Running Experiments:  62%|██████▏   | 56/90 [06:33<05:27,  9.64s/it]
Running Experiments:  63%|██████▎   | 57/90 [06:39<04:34,  8.32s/it]
Running Experiments:  64%|██████▍   | 58/90 [06:40<03:22,  6.34s/it]
Running Experiments:  66%|██████▌   | 59/90 [06:56<04:45,  9.22s/it]
Running Experiments:  67%|██████▋   | 60/90 [06:58<03:30,  7.01s/it]
Running Experiments:  68%|██████▊   | 61/90 [07:15<04:49,  9.99s/it]
Running Experiments:  69%|██████▉   | 62/90 [07:16<03:25,  7.34s/it]
Running Experiments:  70%|███████   | 63/90 [07:19<02:38,  5.87s/it]
Running Experiments:  71%|███████   | 64/90 [07:20<01:56,  4.46s/it]
Running Experiments:  72%|███████▏  | 65/90 [07:32<02:52,  6.89s/it]
Running Experiments:  73%|███████▎  | 66/90 [07:36<02:19,  5.83s/it]
Running Experiments:  74%|███████▍  | 67/90 [07:38<01:45,  4.60s/it]
Running Experiments:  76%|███████▌  | 68/90 [07:41<01:31,  4.16s/it]
Running Experiments:  77%|███████▋  | 69/90 [07:44<01:20,  3.82s/it]
Running Experiments:  78%|███████▊  | 70/90 [08:01<02:39,  7.98s/it]
Running Experiments:  79%|███████▉  | 71/90 [08:03<01:52,  5.94s/it]
Running Experiments:  80%|████████  | 72/90 [08:04<01:21,  4.52s/it]
Running Experiments:  81%|████████  | 73/90 [08:04<00:56,  3.32s/it]
Running Experiments:  82%|████████▏ | 74/90 [08:06<00:46,  2.90s/it]
Running Experiments:  83%|████████▎ | 75/90 [08:09<00:42,  2.81s/it]
Running Experiments:  84%|████████▍ | 76/90 [08:13<00:43,  3.14s/it]
Running Experiments:  86%|████████▌ | 77/90 [08:19<00:52,  4.01s/it]
Running Experiments:  87%|████████▋ | 78/90 [08:22<00:46,  3.85s/it]
Running Experiments:  88%|████████▊ | 79/90 [08:26<00:41,  3.75s/it]
Running Experiments:  89%|████████▉ | 80/90 [08:29<00:36,  3.62s/it]
Running Experiments:  90%|█████████ | 81/90 [08:32<00:29,  3.28s/it]
Running Experiments:  91%|█████████ | 82/90 [08:32<00:20,  2.55s/it]
Running Experiments:  92%|█████████▏| 83/90 [08:34<00:16,  2.29s/it]
Running Experiments:  93%|█████████▎| 84/90 [08:38<00:15,  2.66s/it]
Running Experiments:  94%|█████████▍| 85/90 [08:57<00:38,  7.76s/it]
Running Experiments:  96%|█████████▌| 86/90 [09:17<00:45, 11.45s/it]
Running Experiments:  97%|█████████▋| 87/90 [09:21<00:27,  9.01s/it]
Running Experiments:  98%|█████████▊| 88/90 [09:36<00:21, 10.77s/it]
Running Experiments:  99%|█████████▉| 89/90 [09:40<00:08,  8.90s/it]
Running Experiments: 100%|██████████| 90/90 [09:45<00:00,  7.59s/it]
Running Experiments: 100%|██████████| 90/90 [09:45<00:00,  6.50s/it]

2025-08-30 16:04:05,577 - INFO - --- Step Succeeded: /home/topcuoglu/miniconda3/envs/orh/bin/python src/06_recombinhunt/run_recombinhunt.py --virus monkeypox --config config/config.yaml ---
2025-08-30 16:04:05,577 - INFO - ================== PIPELINE FOR MONKEYPOX FINISHED ==================


