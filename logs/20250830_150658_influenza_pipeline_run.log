2025-08-30 15:06:58,578 - INFO - Logging initialized. Log file at: logs/20250830_150658_influenza_pipeline_run.log
2025-08-30 15:06:58,578 - INFO - ================== STARTING PIPELINE FOR: INFLUENZA ==================
2025-08-30 15:06:58,578 - INFO - --- Executing: /home/topcuoglu/miniconda3/envs/orh/bin/python src/02_preprocessing/ftp/prep_metadata_ftp.py --virus influenza --config config/config.yaml ---
2025-08-30 15:09:57,239 - INFO - Stdout from step:
INFO: Logging initialized. Log file at: logs/20250830_150659_influenza_02.1_prep_metadata_ftp.log
INFO: Loading raw metadata from data/raw/influenza/raw_metadata.csv...
INFO: Starting metadata processing...
INFO: Step 1: Applying filtering rules...
INFO:   Filtering complete. Kept 13620 rows out of 14342667.
INFO: Step 2: Renaming columns to standard format...
INFO: Step 3: Creating 'Pango lineage' column and setting to 'A.1'...
INFO: Step 4: Formatting Location and Date columns...
INFO:   - Formatting 'Location' column...
INFO:   - Formatting date columns...
INFO: Processing complete. Final DataFrame has 13620 rows.
INFO: Saving processed metadata (13620 rows) to data/processed/influenza/metadata.tsv...
INFO: Saving 13620 unique accession IDs to data/processed/influenza/influenza-accession-ids.txt...
INFO: Script finished successfully.

2025-08-30 15:09:57,239 - WARNING - Stderr from step:
/home/topcuoglu/openrecombinhunt/src/02_preprocessing/ftp/prep_metadata_ftp.py:128: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final['Location'] = "North America / " + df_final['Location']

2025-08-30 15:09:57,239 - INFO - --- Step Succeeded: /home/topcuoglu/miniconda3/envs/orh/bin/python src/02_preprocessing/ftp/prep_metadata_ftp.py --virus influenza --config config/config.yaml ---
2025-08-30 15:09:57,240 - INFO - --- Executing: /home/topcuoglu/miniconda3/envs/orh/bin/python src/02_preprocessing/ftp/fetch_ftp_sequences_by_id.py --virus influenza --config config/config.yaml ---
2025-08-30 15:10:04,635 - INFO - Stdout from step:
INFO: Logging initialized. Log file at: logs/20250830_150957_influenza_02.2_fetch_sequences_by_id.log
INFO: --- Starting Step 2.2: Fetch Sequences by ID for 'influenza' ---
INFO: Created temporary working directory: data/processed/influenza/temp_fetch_sequences
INFO: Executing: datasets download virus genome accession --inputfile influenza-accession-ids.txt --filename influenza-sequences.zip
INFO: Unzipping data/processed/influenza/temp_fetch_sequences/influenza-sequences.zip...
INFO: Found: data/processed/influenza/temp_fetch_sequences/ncbi_dataset/data/genomic.fna. Moving and renaming to data/processed/influenza/sequences.fasta
INFO: Cleaning up temporary working directory...
INFO: Cleanup complete.
INFO: Sequence fetching step finished successfully.

2025-08-30 15:10:04,635 - INFO - --- Step Succeeded: /home/topcuoglu/miniconda3/envs/orh/bin/python src/02_preprocessing/ftp/fetch_ftp_sequences_by_id.py --virus influenza --config config/config.yaml ---
2025-08-30 15:10:04,635 - INFO - --- Executing: /home/topcuoglu/miniconda3/envs/orh/bin/python src/02_preprocessing/ftp/fetch_ftp_reference.py --virus influenza --config config/config.yaml ---
2025-08-30 15:10:05,430 - INFO - Stdout from step:
INFO: Logging initialized. Log file at: logs/20250830_151004_influenza_02.3_fetch_reference.log
INFO: --- Starting Step 2.3: Fetch Reference Sequence for 'influenza' ---
INFO: Found reference accession ID: NC_007362.1
INFO: Created temporary working directory: data/processed/influenza/temp_fetch_reference
INFO: Executing: datasets download virus genome accession NC_007362.1 --include genome --filename influenza-reference.zip
INFO: Unzipping data/processed/influenza/temp_fetch_reference/influenza-reference.zip...
INFO: Found: data/processed/influenza/temp_fetch_reference/ncbi_dataset/data/genomic.fna. Moving and renaming to data/processed/influenza/reference.fasta
INFO: Cleaning up temporary working directory...
INFO: Cleanup complete.
INFO: Reference sequence fetching step finished successfully.

2025-08-30 15:10:05,430 - INFO - --- Step Succeeded: /home/topcuoglu/miniconda3/envs/orh/bin/python src/02_preprocessing/ftp/fetch_ftp_reference.py --virus influenza --config config/config.yaml ---
2025-08-30 15:10:05,430 - INFO - --- Executing: /home/topcuoglu/miniconda3/envs/orh/bin/python src/03_haplocov/run_haplocov.py --virus influenza --config config/config.yaml ---
2025-08-30 15:10:05,913 - ERROR - --- Step FAILED: /home/topcuoglu/miniconda3/envs/orh/bin/python src/03_haplocov/run_haplocov.py --virus influenza --config config/config.yaml ---
2025-08-30 15:10:05,913 - ERROR - Return Code: 1
2025-08-30 15:10:05,913 - ERROR - Stderr:

2025-08-30 15:10:05,913 - ERROR - Stdout:
INFO: Logging initialized. Log file at: logs/20250830_151005_influenza_03_run_haplocov.log
INFO: --- Starting Step 3: Run HaploCoV for 'influenza' ---
INFO: Created temporary working directory: results/haplocov_output/influenza/dist5size50/temp_work
INFO: Creating symbolic links for input files in temporary directory...
INFO: Executing HaploCoV with designation_mode: 'haplocov'
INFO: Executing: perl ../../../../../libs/haplocov/addToTableNCBI.pl --metadata metadata.tsv --ref reference.fasta --seq sequences.fasta --outfile out.HaploCoV --nproc 16
ERROR: Command failed with exit code 1
ERROR: Command: perl ../../../../../libs/haplocov/addToTableNCBI.pl --metadata metadata.tsv --ref reference.fasta --seq sequences.fasta --outfile out.HaploCoV --nproc 16
ERROR: Stderr: reference.fasta: unknown argument
Valid arguments are --infile --outfile --genomes --ref
All those moments will be lost in time, like tears in rain.
 Time to die!
_variants: unknown argument
Valid arguments are --infile --outfile --genomes --ref
All those moments will be lost in time, like tears in rain.
 Time to die!
No valid input file provided. --ref does not exist! at align.pl line 219.
reference.fasta: unknown argument
reference.fasta: unknown argument
Valid arguments are --infile --genomes --outfile --ref
All those moments will be lost in time, like tears in rain.
 Time to die!
Valid arguments are --genomes --ref --outfile --infile
All those moments will be lost in time, like tears in rain.
 Time to die!
_variants: unknown argument
Valid arguments are --infile --genomes --outfile --ref
All those moments will be lost in time, like tears in rain.
 Time to die!
_variants: unknown argument
Valid arguments are --genomes --ref --outfile --infile
All those moments will be lost in time, like tears in rain.
 Time to die!
No valid input file provided. --ref does not exist! at align.pl line 219.
No valid input file provided. --ref does not exist! at align.pl line 219.
reference.fasta: unknown argument
Valid arguments are --genomes --infile --ref --outfile
All those moments will be lost in time, like tears in rain.
 Time to die!
_variants: unknown argument
Valid arguments are --genomes --infile --ref --outfile
All those moments will be lost in time, like tears in rain.
 Time to die!
No valid input file provided. --ref does not exist! at align.pl line 219.
reference.fasta: unknown argument
Valid arguments are --infile --outfile --ref --genomes
All those moments will be lost in time, like tears in rain.
 Time to die!
_variants: unknown argument
Valid arguments are --infile --outfile --ref --genomes
All those moments will be lost in time, like tears in rain.
 Time to die!
No valid input file provided. --ref does not exist! at align.pl line 219.
reference.fasta: unknown argument
Valid arguments are --ref --outfile --infile --genomes
All those moments will be lost in time, like tears in rain.
 Time to die!
_variants: unknown argument
Valid arguments are --ref --outfile --infile --genomes
All those moments will be lost in time, like tears in rain.
 Time to die!
No valid input file provided. --ref does not exist! at align.pl line 219.
reference.fasta: unknown argument
Valid arguments are --infile --ref --genomes --outfile
All those moments will be lost in time, like tears in rain.
 Time to die!
_variants: unknown argument
Valid arguments are --infile --ref --genomes --outfile
All those moments will be lost in time, like tears in rain.
 Time to die!
No valid input file provided. --ref does not exist! at align.pl line 219.
reference.fasta: unknown argument
Valid arguments are --infile --genomes --outfile --ref
All those moments will be lost in time, like tears in rain.
 Time to die!
_variants: unknown argument
Valid arguments are --infile --genomes --outfile --ref
All those moments will be lost in time, like tears in rain.
 Time to die!
No valid input file provided. --ref does not exist! at align.pl line 219.
reference.fasta: unknown argument
Valid arguments are --outfile --ref --genomes --infile
All those moments will be lost in time, like tears in rain.
 Time to die!
_variants: unknown argument
Valid arguments are --outfile --ref --genomes --infile
All those moments will be lost in time, like tears in rain.
 Time to die!
No valid input file provided. --ref does not exist! at align.pl line 219.
reference.fasta: unknown argument
Valid arguments are --infile --outfile --genomes --ref
All those moments will be lost in time, like tears in rain.
 Time to die!
_variants: unknown argument
Valid arguments are --infile --outfile --genomes --ref
All those moments will be lost in time, like tears in rain.
 Time to die!
No valid input file provided. --ref does not exist! at align.pl line 219.
reference.fasta: unknown argument
Valid arguments are --ref --outfile --infile --genomes
All those moments will be lost in time, like tears in rain.
 Time to die!
_variants: unknown argument
Valid arguments are --ref --outfile --infile --genomes
All those moments will be lost in time, like tears in rain.
 Time to die!
No valid input file provided. --ref does not exist! at align.pl line 219.
reference.fasta: unknown argument
Valid arguments are --infile --ref --genomes --outfile
All those moments will be lost in time, like tears in rain.
 Time to die!
reference.fasta: unknown argument
_variants: unknown argument
Valid arguments are --ref --outfile --genomes --infile
Valid arguments are --infile --ref --genomes --outfile
All those moments will be lost in time, like tears in rain.
 Time to die!
All those moments will be lost in time, like tears in rain.
 Time to die!
No valid input file provided. --ref does not exist! at align.pl line 219.
_variants: unknown argument
Valid arguments are --ref --outfile --genomes --infile
All those moments will be lost in time, like tears in rain.
 Time to die!
No valid input file provided. --ref does not exist! at align.pl line 219.
reference.fasta: unknown argument
Valid arguments are --genomes --outfile --ref --infile
All those moments will be lost in time, like tears in rain.
 Time to die!
_variants: unknown argument
Valid arguments are --genomes --outfile --ref --infile
All those moments will be lost in time, like tears in rain.
 Time to die!
No valid input file provided. --ref does not exist! at align.pl line 219.
reference.fasta: unknown argument
Valid arguments are --genomes --outfile --ref --infile
All those moments will be lost in time, like tears in rain.
 Time to die!
_variants: unknown argument
Valid arguments are --genomes --outfile --ref --infile
All those moments will be lost in time, like tears in rain.
 Time to die!
No valid input file provided. --ref does not exist! at align.pl line 219.
cat: _variants: No such file or directory
Died at ../../../../../libs/haplocov/addToTableNCBI.pl line 358, <IN> line 381839.

ERROR: Stdout: indexing out.HaploCoV
indexing done
Now reading input metadata file
metadata read done
Now subsetting the fasta file
Adding 1 sequences
 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

Now aligning with 16 processes

INFO: HaploCoV step completed.
CRITICAL: HaploCoV step failed with a critical error: Command 'perl ../../../../../libs/haplocov/addToTableNCBI.pl --metadata metadata.tsv --ref reference.fasta --seq sequences.fasta --outfile out.HaploCoV --nproc 16' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/topcuoglu/openrecombinhunt/src/03_haplocov/run_haplocov.py", line 147, in main
    run_haplocov_step(args.virus, config)
  File "/home/topcuoglu/openrecombinhunt/src/03_haplocov/run_haplocov.py", line 110, in run_haplocov_step
    run_command(command, working_dir=temp_work_dir)
  File "/home/topcuoglu/openrecombinhunt/src/utils/utils.py", line 53, in run_command
    result = subprocess.run(
  File "/home/topcuoglu/miniconda3/envs/orh/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command 'perl ../../../../../libs/haplocov/addToTableNCBI.pl --metadata metadata.tsv --ref reference.fasta --seq sequences.fasta --outfile out.HaploCoV --nproc 16' returned non-zero exit status 1.

2025-08-30 15:10:05,915 - CRITICAL - Pipeline for 'influenza' failed at step: /home/topcuoglu/miniconda3/envs/orh/bin/python src/03_haplocov/run_haplocov.py --virus influenza --config config/config.yaml
2025-08-30 15:10:05,916 - CRITICAL - Aborting pipeline for this virus.
2025-08-30 15:10:05,916 - INFO - ================== PIPELINE FOR INFLUENZA FINISHED ==================


