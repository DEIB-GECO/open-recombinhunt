2025-08-30 15:10:05,546 - INFO - Logging initialized. Log file at: logs/20250830_151005_influenza_03_run_haplocov.log
2025-08-30 15:10:05,546 - INFO - --- Starting Step 3: Run HaploCoV for 'influenza' ---
2025-08-30 15:10:05,546 - INFO - Created temporary working directory: results/haplocov_output/influenza/dist5size50/temp_work
2025-08-30 15:10:05,546 - INFO - Creating symbolic links for input files in temporary directory...
2025-08-30 15:10:05,547 - INFO - Executing HaploCoV with designation_mode: 'haplocov'
2025-08-30 15:10:05,547 - INFO - Executing: perl ../../../../../libs/haplocov/addToTableNCBI.pl --metadata metadata.tsv --ref reference.fasta --seq sequences.fasta --outfile out.HaploCoV --nproc 16
2025-08-30 15:10:05,899 - ERROR - Command failed with exit code 1
2025-08-30 15:10:05,900 - ERROR - Command: perl ../../../../../libs/haplocov/addToTableNCBI.pl --metadata metadata.tsv --ref reference.fasta --seq sequences.fasta --outfile out.HaploCoV --nproc 16
2025-08-30 15:10:05,900 - ERROR - Stderr: reference.fasta: unknown argument
Valid arguments are --infile --outfile --genomes --ref
All those moments will be lost in time, like tears in rain.
 Time to die!
_variants: unknown argument
Valid arguments are --infile --outfile --genomes --ref
All those moments will be lost in time, like tears in rain.
 Time to die!
No valid input file provided. --ref does not exist! at align.pl line 219.
reference.fasta: unknown argument
reference.fasta: unknown argument
Valid arguments are --infile --genomes --outfile --ref
All those moments will be lost in time, like tears in rain.
 Time to die!
Valid arguments are --genomes --ref --outfile --infile
All those moments will be lost in time, like tears in rain.
 Time to die!
_variants: unknown argument
Valid arguments are --infile --genomes --outfile --ref
All those moments will be lost in time, like tears in rain.
 Time to die!
_variants: unknown argument
Valid arguments are --genomes --ref --outfile --infile
All those moments will be lost in time, like tears in rain.
 Time to die!
No valid input file provided. --ref does not exist! at align.pl line 219.
No valid input file provided. --ref does not exist! at align.pl line 219.
reference.fasta: unknown argument
Valid arguments are --genomes --infile --ref --outfile
All those moments will be lost in time, like tears in rain.
 Time to die!
_variants: unknown argument
Valid arguments are --genomes --infile --ref --outfile
All those moments will be lost in time, like tears in rain.
 Time to die!
No valid input file provided. --ref does not exist! at align.pl line 219.
reference.fasta: unknown argument
Valid arguments are --infile --outfile --ref --genomes
All those moments will be lost in time, like tears in rain.
 Time to die!
_variants: unknown argument
Valid arguments are --infile --outfile --ref --genomes
All those moments will be lost in time, like tears in rain.
 Time to die!
No valid input file provided. --ref does not exist! at align.pl line 219.
reference.fasta: unknown argument
Valid arguments are --ref --outfile --infile --genomes
All those moments will be lost in time, like tears in rain.
 Time to die!
_variants: unknown argument
Valid arguments are --ref --outfile --infile --genomes
All those moments will be lost in time, like tears in rain.
 Time to die!
No valid input file provided. --ref does not exist! at align.pl line 219.
reference.fasta: unknown argument
Valid arguments are --infile --ref --genomes --outfile
All those moments will be lost in time, like tears in rain.
 Time to die!
_variants: unknown argument
Valid arguments are --infile --ref --genomes --outfile
All those moments will be lost in time, like tears in rain.
 Time to die!
No valid input file provided. --ref does not exist! at align.pl line 219.
reference.fasta: unknown argument
Valid arguments are --infile --genomes --outfile --ref
All those moments will be lost in time, like tears in rain.
 Time to die!
_variants: unknown argument
Valid arguments are --infile --genomes --outfile --ref
All those moments will be lost in time, like tears in rain.
 Time to die!
No valid input file provided. --ref does not exist! at align.pl line 219.
reference.fasta: unknown argument
Valid arguments are --outfile --ref --genomes --infile
All those moments will be lost in time, like tears in rain.
 Time to die!
_variants: unknown argument
Valid arguments are --outfile --ref --genomes --infile
All those moments will be lost in time, like tears in rain.
 Time to die!
No valid input file provided. --ref does not exist! at align.pl line 219.
reference.fasta: unknown argument
Valid arguments are --infile --outfile --genomes --ref
All those moments will be lost in time, like tears in rain.
 Time to die!
_variants: unknown argument
Valid arguments are --infile --outfile --genomes --ref
All those moments will be lost in time, like tears in rain.
 Time to die!
No valid input file provided. --ref does not exist! at align.pl line 219.
reference.fasta: unknown argument
Valid arguments are --ref --outfile --infile --genomes
All those moments will be lost in time, like tears in rain.
 Time to die!
_variants: unknown argument
Valid arguments are --ref --outfile --infile --genomes
All those moments will be lost in time, like tears in rain.
 Time to die!
No valid input file provided. --ref does not exist! at align.pl line 219.
reference.fasta: unknown argument
Valid arguments are --infile --ref --genomes --outfile
All those moments will be lost in time, like tears in rain.
 Time to die!
reference.fasta: unknown argument
_variants: unknown argument
Valid arguments are --ref --outfile --genomes --infile
Valid arguments are --infile --ref --genomes --outfile
All those moments will be lost in time, like tears in rain.
 Time to die!
All those moments will be lost in time, like tears in rain.
 Time to die!
No valid input file provided. --ref does not exist! at align.pl line 219.
_variants: unknown argument
Valid arguments are --ref --outfile --genomes --infile
All those moments will be lost in time, like tears in rain.
 Time to die!
No valid input file provided. --ref does not exist! at align.pl line 219.
reference.fasta: unknown argument
Valid arguments are --genomes --outfile --ref --infile
All those moments will be lost in time, like tears in rain.
 Time to die!
_variants: unknown argument
Valid arguments are --genomes --outfile --ref --infile
All those moments will be lost in time, like tears in rain.
 Time to die!
No valid input file provided. --ref does not exist! at align.pl line 219.
reference.fasta: unknown argument
Valid arguments are --genomes --outfile --ref --infile
All those moments will be lost in time, like tears in rain.
 Time to die!
_variants: unknown argument
Valid arguments are --genomes --outfile --ref --infile
All those moments will be lost in time, like tears in rain.
 Time to die!
No valid input file provided. --ref does not exist! at align.pl line 219.
cat: _variants: No such file or directory
Died at ../../../../../libs/haplocov/addToTableNCBI.pl line 358, <IN> line 381839.

2025-08-30 15:10:05,900 - ERROR - Stdout: indexing out.HaploCoV
indexing done
Now reading input metadata file
metadata read done
Now subsetting the fasta file
Adding 1 sequences
 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

 This utility can be used to 1) download the reference SARS-CoV-2 genome from Genbank
 and 2) align it with a collection of SARS-CoV-2 genomes. And finally 3)Call/identify
 genomic variants.
 On any *nix based system the script should download the reference genome by itself.
 Please download the genome yourself if this fails.
 Input genomes, in multifasta format are provided by the --file parameter.
 While --genomes specify the name of the temporary output files directory

##INPUT PARAMETERS

--ref <<filename>>	 provides a fasta file with the reference genome
--infile <<filename>>	 provides a multifasta of genome sequences
--genomes <<dir name>>	 defaults to ./genomes
--outfile <<filename>>	 name of the output file. Defaults to varcall.list

To run the program you MUST provide at least --infile
the file needs to be in the current folder.


##EXAMPLE:

1# input is multi-fasta (apollo.fa), reference is a fata file (myref.fa):
perl align.pl --infile apollo.fa --ref myref.fa

Now aligning with 16 processes

2025-08-30 15:10:05,900 - INFO - HaploCoV step completed.
2025-08-30 15:10:05,900 - CRITICAL - HaploCoV step failed with a critical error: Command 'perl ../../../../../libs/haplocov/addToTableNCBI.pl --metadata metadata.tsv --ref reference.fasta --seq sequences.fasta --outfile out.HaploCoV --nproc 16' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/topcuoglu/openrecombinhunt/src/03_haplocov/run_haplocov.py", line 147, in main
    run_haplocov_step(args.virus, config)
  File "/home/topcuoglu/openrecombinhunt/src/03_haplocov/run_haplocov.py", line 110, in run_haplocov_step
    run_command(command, working_dir=temp_work_dir)
  File "/home/topcuoglu/openrecombinhunt/src/utils/utils.py", line 53, in run_command
    result = subprocess.run(
  File "/home/topcuoglu/miniconda3/envs/orh/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command 'perl ../../../../../libs/haplocov/addToTableNCBI.pl --metadata metadata.tsv --ref reference.fasta --seq sequences.fasta --outfile out.HaploCoV --nproc 16' returned non-zero exit status 1.
