2025-09-06 13:48:03,446 - INFO - Logging initialized. Log file at: logs/20250906_134803_yellow-fever_06_run_recombinhunt.log
2025-09-06 13:48:03,446 - INFO - --- Starting Step 6: Run RecombinHunt for 'yellow-fever' ---
2025-09-06 13:48:03,446 - INFO - Loading RecombinHunt environment from: environments/yellow-fever/dist3size10
2025-09-06 13:48:03,500 - INFO - Loading lineage totals from 'samples/yellow-fever/dist3size10/samples_total.json'
2025-09-06 13:48:03,501 - INFO - Found 3 sample files in 'samples/yellow-fever/dist3size10'.
2025-09-06 13:48:03,555 - INFO -   Lineage 'A.1.NmC2', Mode 'all': Processing all 195 samples.
2025-09-06 13:48:08,596 - INFO -   Lineage 'A.1.NmC1', Mode 'all': Processing all 377 samples.
2025-09-06 13:48:20,126 - INFO -   Lineage 'A.1', Mode 'all': Processing all 835 samples.
2025-09-06 13:48:30,993 - WARNING - Gap made of only target mutations (How can it be? It's an almost impossible condition). Target mutation that minimizes the loss has been assigned to the right region).
2025-09-06 13:48:32,618 - WARNING - Gap made of only target mutations (How can it be? It's an almost impossible condition). Target mutation that minimizes the loss has been assigned to the right region).
2025-09-06 13:48:33,038 - WARNING - Gap made of only target mutations (How can it be? It's an almost impossible condition). Target mutation that minimizes the loss has been assigned to the right region).
2025-09-06 13:48:38,050 - WARNING - Gap made of only target mutations (How can it be? It's an almost impossible condition). Target mutation that minimizes the loss has been assigned to the right region).
2025-09-06 13:48:38,710 - WARNING - Gap made of only target mutations (How can it be? It's an almost impossible condition). Target mutation that minimizes the loss has been assigned to the right region).
2025-09-06 13:48:44,258 - ERROR -   Error on one sample in lineage A.1: Reindexing only valid with uniquely valued Index objects
Traceback (most recent call last):
  File "/home/topcuoglu/openrecombinhunt/src/06_recombinhunt/run_recombinhunt.py", line 178, in run_recombinhunt_for_lineage
    experiment.set_target(nuc_change_data_list)
  File "/home/topcuoglu/openrecombinhunt/libs/recombinhunt-cov-7.0.0/src/recombinhunt/core/method.py", line 567, in set_target
    self.merged_df = self.env.make_merged_df(seq_df)
  File "/home/topcuoglu/openrecombinhunt/libs/recombinhunt-cov-7.0.0/src/recombinhunt/core/environment.py", line 104, in make_merged_df
    target_and_not_lc_df = pd.concat([
  File "/home/topcuoglu/.local/lib/python3.10/site-packages/pandas/core/reshape/concat.py", line 393, in concat
    return op.get_result()
  File "/home/topcuoglu/.local/lib/python3.10/site-packages/pandas/core/reshape/concat.py", line 676, in get_result
    indexers[ax] = obj_labels.get_indexer(new_labels)
  File "/home/topcuoglu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3874, in get_indexer
    raise InvalidIndexError(self._requires_unique_msg)
pandas.errors.InvalidIndexError: Reindexing only valid with uniquely valued Index objects
2025-09-06 13:48:44,858 - ERROR -   Error on one sample in lineage A.1: Reindexing only valid with uniquely valued Index objects
Traceback (most recent call last):
  File "/home/topcuoglu/openrecombinhunt/src/06_recombinhunt/run_recombinhunt.py", line 178, in run_recombinhunt_for_lineage
    experiment.set_target(nuc_change_data_list)
  File "/home/topcuoglu/openrecombinhunt/libs/recombinhunt-cov-7.0.0/src/recombinhunt/core/method.py", line 567, in set_target
    self.merged_df = self.env.make_merged_df(seq_df)
  File "/home/topcuoglu/openrecombinhunt/libs/recombinhunt-cov-7.0.0/src/recombinhunt/core/environment.py", line 104, in make_merged_df
    target_and_not_lc_df = pd.concat([
  File "/home/topcuoglu/.local/lib/python3.10/site-packages/pandas/core/reshape/concat.py", line 393, in concat
    return op.get_result()
  File "/home/topcuoglu/.local/lib/python3.10/site-packages/pandas/core/reshape/concat.py", line 676, in get_result
    indexers[ax] = obj_labels.get_indexer(new_labels)
  File "/home/topcuoglu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3874, in get_indexer
    raise InvalidIndexError(self._requires_unique_msg)
pandas.errors.InvalidIndexError: Reindexing only valid with uniquely valued Index objects
2025-09-06 13:48:44,867 - ERROR -   Error on one sample in lineage A.1: Reindexing only valid with uniquely valued Index objects
Traceback (most recent call last):
  File "/home/topcuoglu/openrecombinhunt/src/06_recombinhunt/run_recombinhunt.py", line 178, in run_recombinhunt_for_lineage
    experiment.set_target(nuc_change_data_list)
  File "/home/topcuoglu/openrecombinhunt/libs/recombinhunt-cov-7.0.0/src/recombinhunt/core/method.py", line 567, in set_target
    self.merged_df = self.env.make_merged_df(seq_df)
  File "/home/topcuoglu/openrecombinhunt/libs/recombinhunt-cov-7.0.0/src/recombinhunt/core/environment.py", line 104, in make_merged_df
    target_and_not_lc_df = pd.concat([
  File "/home/topcuoglu/.local/lib/python3.10/site-packages/pandas/core/reshape/concat.py", line 393, in concat
    return op.get_result()
  File "/home/topcuoglu/.local/lib/python3.10/site-packages/pandas/core/reshape/concat.py", line 676, in get_result
    indexers[ax] = obj_labels.get_indexer(new_labels)
  File "/home/topcuoglu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3874, in get_indexer
    raise InvalidIndexError(self._requires_unique_msg)
pandas.errors.InvalidIndexError: Reindexing only valid with uniquely valued Index objects
2025-09-06 13:48:50,900 - INFO - Recombinant summary saved to: results/recombinhunt_output/yellow-fever/dist3size10/recombinant_summary.tsv
2025-09-06 13:48:50,917 - INFO - Saved extensive summary table to: results/recombinhunt_output/yellow-fever/dist3size10/recombinant_summary_extensive.tsv
2025-09-06 13:48:50,917 - INFO - Text report saved to: results/recombinhunt_output/yellow-fever/dist3size10/experiment-output.all.txt
2025-09-06 13:48:50,917 - INFO - HTML report saved to: results/recombinhunt_output/yellow-fever/dist3size10/experiment-detail.all.html
2025-09-06 13:48:50,918 - INFO - RecombinHunt experiment step finished successfully with given config and run mode.
