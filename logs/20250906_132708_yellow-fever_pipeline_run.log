2025-09-06 13:27:08,929 - INFO - Logging initialized. Log file at: logs/20250906_132708_yellow-fever_pipeline_run.log
2025-09-06 13:27:08,929 - INFO - ================== STARTING PIPELINE FOR: YELLOW-FEVER ==================
2025-09-06 13:27:08,930 - INFO - --- Executing: /home/topcuoglu/miniconda3/envs/orh/bin/python src/06_recombinhunt/run_recombinhunt.py --virus yellow-fever --config config/config.yaml ---
2025-09-06 13:27:57,766 - INFO - Stdout from step:
INFO: Logging initialized. Log file at: logs/20250906_132710_yellow-fever_06_run_recombinhunt.log
INFO: --- Starting Step 6: Run RecombinHunt for 'yellow-fever' ---
INFO: Loading RecombinHunt environment from: environments/yellow-fever/dist3size10
Starting formal checks of the environment...
INFO: Loading lineage totals from 'samples/yellow-fever/dist3size10/samples_total.json'
INFO: Found 3 sample files in 'samples/yellow-fever/dist3size10'.
INFO:   Lineage 'A.1.NmC2', Mode 'all': Processing all 195 samples.
INFO:   Lineage 'A.1.NmC1', Mode 'all': Processing all 377 samples.
INFO:   Lineage 'A.1', Mode 'all': Processing all 835 samples.
WARNING: Gap made of only target mutations (How can it be? It's an almost impossible condition). Target mutation that minimizes the loss has been assigned to the right region).
WARNING: Gap made of only target mutations (How can it be? It's an almost impossible condition). Target mutation that minimizes the loss has been assigned to the right region).
WARNING: Gap made of only target mutations (How can it be? It's an almost impossible condition). Target mutation that minimizes the loss has been assigned to the right region).
WARNING: Gap made of only target mutations (How can it be? It's an almost impossible condition). Target mutation that minimizes the loss has been assigned to the right region).
WARNING: Gap made of only target mutations (How can it be? It's an almost impossible condition). Target mutation that minimizes the loss has been assigned to the right region).
ERROR:   Error on one sample in lineage A.1: Reindexing only valid with uniquely valued Index objects
Traceback (most recent call last):
  File "/home/topcuoglu/openrecombinhunt/src/06_recombinhunt/run_recombinhunt.py", line 178, in run_recombinhunt_for_lineage
    experiment.set_target(nuc_change_data_list)
  File "/home/topcuoglu/openrecombinhunt/libs/recombinhunt-cov-7.0.0/src/recombinhunt/core/method.py", line 567, in set_target
    self.merged_df = self.env.make_merged_df(seq_df)
  File "/home/topcuoglu/openrecombinhunt/libs/recombinhunt-cov-7.0.0/src/recombinhunt/core/environment.py", line 104, in make_merged_df
    target_and_not_lc_df = pd.concat([
  File "/home/topcuoglu/.local/lib/python3.10/site-packages/pandas/core/reshape/concat.py", line 393, in concat
    return op.get_result()
  File "/home/topcuoglu/.local/lib/python3.10/site-packages/pandas/core/reshape/concat.py", line 676, in get_result
    indexers[ax] = obj_labels.get_indexer(new_labels)
  File "/home/topcuoglu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3874, in get_indexer
    raise InvalidIndexError(self._requires_unique_msg)
pandas.errors.InvalidIndexError: Reindexing only valid with uniquely valued Index objects
ERROR:   Error on one sample in lineage A.1: Reindexing only valid with uniquely valued Index objects
Traceback (most recent call last):
  File "/home/topcuoglu/openrecombinhunt/src/06_recombinhunt/run_recombinhunt.py", line 178, in run_recombinhunt_for_lineage
    experiment.set_target(nuc_change_data_list)
  File "/home/topcuoglu/openrecombinhunt/libs/recombinhunt-cov-7.0.0/src/recombinhunt/core/method.py", line 567, in set_target
    self.merged_df = self.env.make_merged_df(seq_df)
  File "/home/topcuoglu/openrecombinhunt/libs/recombinhunt-cov-7.0.0/src/recombinhunt/core/environment.py", line 104, in make_merged_df
    target_and_not_lc_df = pd.concat([
  File "/home/topcuoglu/.local/lib/python3.10/site-packages/pandas/core/reshape/concat.py", line 393, in concat
    return op.get_result()
  File "/home/topcuoglu/.local/lib/python3.10/site-packages/pandas/core/reshape/concat.py", line 676, in get_result
    indexers[ax] = obj_labels.get_indexer(new_labels)
  File "/home/topcuoglu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3874, in get_indexer
    raise InvalidIndexError(self._requires_unique_msg)
pandas.errors.InvalidIndexError: Reindexing only valid with uniquely valued Index objects
ERROR:   Error on one sample in lineage A.1: Reindexing only valid with uniquely valued Index objects
Traceback (most recent call last):
  File "/home/topcuoglu/openrecombinhunt/src/06_recombinhunt/run_recombinhunt.py", line 178, in run_recombinhunt_for_lineage
    experiment.set_target(nuc_change_data_list)
  File "/home/topcuoglu/openrecombinhunt/libs/recombinhunt-cov-7.0.0/src/recombinhunt/core/method.py", line 567, in set_target
    self.merged_df = self.env.make_merged_df(seq_df)
  File "/home/topcuoglu/openrecombinhunt/libs/recombinhunt-cov-7.0.0/src/recombinhunt/core/environment.py", line 104, in make_merged_df
    target_and_not_lc_df = pd.concat([
  File "/home/topcuoglu/.local/lib/python3.10/site-packages/pandas/core/reshape/concat.py", line 393, in concat
    return op.get_result()
  File "/home/topcuoglu/.local/lib/python3.10/site-packages/pandas/core/reshape/concat.py", line 676, in get_result
    indexers[ax] = obj_labels.get_indexer(new_labels)
  File "/home/topcuoglu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3874, in get_indexer
    raise InvalidIndexError(self._requires_unique_msg)
pandas.errors.InvalidIndexError: Reindexing only valid with uniquely valued Index objects
INFO: Recombinant summary saved to: results/recombinhunt_output/yellow-fever/dist3size10/recombinant_summary.tsv
INFO: Saved extensive summary table to: results/recombinhunt_output/yellow-fever/dist3size10/recombinant_summary_extensive.tsv
INFO: Text report saved to: results/recombinhunt_output/yellow-fever/dist3size10/experiment-output.all.txt
INFO: HTML report saved to: results/recombinhunt_output/yellow-fever/dist3size10/experiment-detail.all.html
INFO: RecombinHunt experiment step finished successfully with given config and run mode.

2025-09-06 13:27:57,767 - WARNING - Stderr from step:
/home/topcuoglu/openrecombinhunt/libs/recombinhunt-cov-7.0.0/src/recombinhunt/core/environment.py:237: UserWarning: RecombinHunt 5.+ expects a candidates_hierarchy.json in the environment dir but the file is missing. Backward compatibility is possible by calling Environment.embed_candidates_hierarchy() with a CandidatesHierarchy object. Resorting to default CandidatesHierarchy.
  warnings.warn("RecombinHunt 5.+ expects a candidates_hierarchy.json in the environment dir but the file is missing. Backward compatibility is possible by"

Running Experiments:   0%|          | 0/3 [00:00<?, ?it/s]
Running Experiments:  33%|███▎      | 1/3 [00:04<00:09,  4.95s/it]
Running Experiments:  67%|██████▋   | 2/3 [00:16<00:08,  8.74s/it]
Running Experiments: 100%|██████████| 3/3 [00:47<00:00, 18.98s/it]
Running Experiments: 100%|██████████| 3/3 [00:47<00:00, 15.84s/it]

2025-09-06 13:27:57,767 - INFO - --- Step Succeeded: /home/topcuoglu/miniconda3/envs/orh/bin/python src/06_recombinhunt/run_recombinhunt.py --virus yellow-fever --config config/config.yaml ---
2025-09-06 13:27:57,767 - INFO - ================== PIPELINE FOR YELLOW-FEVER FINISHED ==================


