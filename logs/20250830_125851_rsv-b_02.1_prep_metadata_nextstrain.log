2025-08-30 12:58:51,024 - INFO - Logging initialized. Log file at: logs/20250830_125851_rsv-b_02.1_prep_metadata_nextstrain.log
2025-08-30 12:58:51,025 - INFO - Loading raw metadata from data/raw/rsv-b/raw_metadata.tsv...
2025-08-30 12:58:51,220 - INFO - Starting preprocessing of Nextstrain metadata with 23332 rows.
2025-08-30 12:58:51,221 - INFO - Step 1: Applying quality filters from config...
2025-08-30 12:58:51,229 - INFO -   Filter 'accession notna None': Removed 0 rows.
2025-08-30 12:58:51,234 - INFO -   Filter 'date notna None': Removed 0 rows.
2025-08-30 12:58:51,242 - INFO -   Filter 'qc.overallStatus == good': Removed 1104 rows.
2025-08-30 12:58:51,248 - INFO -   Filter 'missing_data < 3': Removed 2758 rows.
2025-08-30 12:58:51,248 - INFO - Step 2: Checking for special characters in ID...
2025-08-30 12:58:51,261 - INFO -   Filter 'Special Chars in ID': Removed 0 rows.
2025-08-30 12:58:51,261 - INFO - Step 3: Processing lineage column...
2025-08-30 12:58:51,261 - INFO - Using source column 'clade' for lineage information.
2025-08-30 12:58:51,266 - INFO -   Identified and removed 0 non-classified rows (missing 'clade').
2025-08-30 12:58:51,266 - INFO - Step 4: Performing final formatting...
2025-08-30 12:58:51,269 - INFO - Formatting date columns...
2025-08-30 12:58:51,271 - INFO -   - Analyzing and formatting 'Collection date'
2025-08-30 12:58:51,291 - INFO -     Removed 1419 rows with incomplete 'XXXX' dates.
2025-08-30 12:58:51,330 - INFO -     Date format statistics for 'Collection date':
2025-08-30 12:58:51,330 - INFO -       YYYY-MM-DD format: 12521
2025-08-30 12:58:51,330 - INFO -       YYYY-MM format   : 0
2025-08-30 12:58:51,330 - INFO -       YYYY format      : 0
2025-08-30 12:58:51,330 - INFO -       Other/unparseable: 5530
2025-08-30 12:58:51,330 - INFO -       Missing (NA)     : 0
2025-08-30 12:58:51,368 - INFO -   - Analyzing and formatting 'Submission date'
2025-08-30 12:58:51,413 - INFO -     Date format statistics for 'Submission date':
2025-08-30 12:58:51,413 - INFO -       YYYY-MM-DD format: 18051
2025-08-30 12:58:51,414 - INFO -       YYYY-MM format   : 0
2025-08-30 12:58:51,414 - INFO -       YYYY format      : 0
2025-08-30 12:58:51,414 - INFO -       Other/unparseable: 0
2025-08-30 12:58:51,414 - INFO -       Missing (NA)     : 0
2025-08-30 12:58:51,452 - INFO - Formatting 'Location' column by combining 'region' and 'country'...
2025-08-30 12:58:51,644 - INFO - Preprocessing complete. Final dataset has 18051 rows.
2025-08-30 12:58:51,651 - INFO - Saving processed metadata (18051 rows) to data/processed/rsv-b/metadata.tsv...
2025-08-30 12:58:51,694 - INFO - Saving 5281 quality-filtered sequence IDs to data/processed/rsv-b/filtered_sequence_ids.txt...
2025-08-30 12:58:51,694 - INFO - Saving 0 non-classified sequence IDs to data/processed/rsv-b/non_classified_sequence_ids.txt...
2025-08-30 12:58:51,694 - INFO - Script finished successfully.
