2025-07-17 12:29:01,001 - INFO - Logging initialized. Log file at: logs/20250717_122901_sars-cov-2_02.1_prep_metadata_nextstrain.log
2025-07-17 12:29:01,016 - INFO - Loading raw metadata from data/raw/sars-cov-2/raw_metadata.tsv...
2025-07-17 12:33:42,631 - INFO - Starting preprocessing of Nextstrain metadata with 9351099 rows.
2025-07-17 12:33:42,700 - INFO - Step 1: Applying quality filters from config...
2025-07-17 12:33:51,258 - INFO -   Filter 'coverage >= 0.99': Removed 3846335 rows.
2025-07-17 12:33:55,334 - INFO -   Filter 'missing_data < 589': Removed 0 rows.
2025-07-17 12:33:59,529 - INFO -   Filter 'virus == ncov': Removed 0 rows.
2025-07-17 12:34:04,003 - INFO -   Filter 'virus notna None': Removed 0 rows.
2025-07-17 12:34:07,877 - INFO -   Filter 'length notna None': Removed 0 rows.
2025-07-17 12:34:12,336 - INFO -   Filter 'date_submitted notna None': Removed 0 rows.
2025-07-17 12:34:16,871 - INFO -   Filter 'QC_overall_status notna None': Removed 0 rows.
2025-07-17 12:34:22,278 - INFO -   Filter 'QC_overall_status != bad': Removed 143624 rows.
2025-07-17 12:34:26,715 - INFO -   Filter 'QC_missing_data == good': Removed 0 rows.
2025-07-17 12:34:31,920 - INFO -   Filter 'QC_frame_shifts == good': Removed 71750 rows.
2025-07-17 12:34:36,875 - INFO -   Filter 'QC_stop_codons == good': Removed 8760 rows.
2025-07-17 12:34:42,248 - INFO -   Filter 'QC_mixed_sites == good': Removed 258033 rows.
2025-07-17 12:34:42,248 - INFO - Step 2: Checking for special characters in ID...
2025-07-17 12:34:50,063 - INFO -   Filter 'Special Chars in ID': Removed 4292794 rows.
2025-07-17 12:34:50,063 - INFO - Step 3: Processing lineage column...
2025-07-17 12:34:50,063 - INFO - Using source column 'pango_lineage' for lineage information.
2025-07-17 12:34:50,617 - INFO -   Identified and removed 0 non-classified rows (missing 'pango_lineage').
2025-07-17 12:34:50,617 - INFO - Step 4: Performing final formatting...
2025-07-17 12:34:51,136 - INFO - Formatting date columns...
2025-07-17 12:34:51,497 - INFO -   - Analyzing and formatting 'Collection date'
2025-07-17 12:34:52,912 - INFO -     Removed 407 rows with incomplete 'XXXX' dates.
2025-07-17 12:34:55,505 - INFO -     Date format statistics for 'Collection date':
2025-07-17 12:34:55,505 - INFO -       YYYY-MM-DD format: 721676
2025-07-17 12:34:55,505 - INFO -       YYYY-MM format   : 207
2025-07-17 12:34:55,506 - INFO -       YYYY format      : 6943
2025-07-17 12:34:55,506 - INFO -       Other/unparseable: 559
2025-07-17 12:34:55,506 - INFO -       Missing (NA)     : 11
2025-07-17 12:34:57,235 - INFO -   - Analyzing and formatting 'Submission date'
2025-07-17 12:34:58,994 - INFO -     Date format statistics for 'Submission date':
2025-07-17 12:34:58,994 - INFO -       YYYY-MM-DD format: 729396
2025-07-17 12:34:58,994 - INFO -       YYYY-MM format   : 0
2025-07-17 12:34:58,994 - INFO -       YYYY format      : 0
2025-07-17 12:34:58,994 - INFO -       Other/unparseable: 0
2025-07-17 12:34:58,994 - INFO -       Missing (NA)     : 0
2025-07-17 12:35:00,843 - INFO - Formatting 'Location' column by combining 'region' and 'country'...
2025-07-17 12:35:15,475 - INFO - Preprocessing complete. Final dataset has 729396 rows.
2025-07-17 12:35:24,567 - INFO - Saving processed metadata (729396 rows) to data/processed/sars-cov-2/metadata.tsv...
2025-07-17 12:35:26,267 - INFO - Saving 8621703 quality-filtered sequence IDs to data/processed/sars-cov-2/filtered_sequence_ids.txt...
2025-07-17 12:35:26,982 - INFO - Saving 0 non-classified sequence IDs to data/processed/sars-cov-2/non_classified_sequence_ids.txt...
2025-07-17 12:35:26,982 - INFO - Script finished successfully.
