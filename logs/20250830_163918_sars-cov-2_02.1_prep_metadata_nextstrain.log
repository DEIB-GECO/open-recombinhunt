2025-08-30 16:39:18,432 - INFO - Logging initialized. Log file at: logs/20250830_163918_sars-cov-2_02.1_prep_metadata_nextstrain.log
2025-08-30 16:39:18,432 - INFO - Loading raw metadata from data/raw/sars-cov-2/raw_metadata.tsv...
2025-08-30 16:43:46,573 - INFO - Starting preprocessing of Nextstrain metadata with 9369573 rows.
2025-08-30 16:43:46,574 - INFO - Step 1: Applying quality filters from config...
2025-08-30 16:43:55,105 - INFO -   Filter 'missing_data < 589': Removed 1939592 rows.
2025-08-30 16:44:01,379 - INFO -   Filter 'coverage >= 0.99': Removed 1917184 rows.
2025-08-30 16:44:05,622 - INFO -   Filter 'virus == ncov': Removed 0 rows.
2025-08-30 16:44:10,194 - INFO -   Filter 'virus notna None': Removed 0 rows.
2025-08-30 16:44:13,933 - INFO -   Filter 'length notna None': Removed 0 rows.
2025-08-30 16:44:18,034 - INFO -   Filter 'date_submitted notna None': Removed 0 rows.
2025-08-30 16:44:22,479 - INFO -   Filter 'QC_overall_status notna None': Removed 0 rows.
2025-08-30 16:44:27,831 - INFO -   Filter 'QC_overall_status != bad': Removed 144294 rows.
2025-08-30 16:44:32,114 - INFO -   Filter 'QC_missing_data == good': Removed 0 rows.
2025-08-30 16:44:37,199 - INFO -   Filter 'QC_frame_shifts == good': Removed 72162 rows.
2025-08-30 16:44:42,168 - INFO -   Filter 'QC_stop_codons == good': Removed 8750 rows.
2025-08-30 16:44:47,326 - INFO -   Filter 'QC_mixed_sites == good': Removed 258015 rows.
2025-08-30 16:44:47,326 - INFO - Step 3: Processing lineage column...
2025-08-30 16:44:47,326 - INFO - Using source column 'pango_lineage' for lineage information.
2025-08-30 16:44:51,337 - INFO -   Identified and removed 0 non-classified rows (missing 'pango_lineage').
2025-08-30 16:44:51,337 - INFO - Step 4: Performing final formatting...
2025-08-30 16:44:54,937 - INFO - Formatting date columns...
2025-08-30 16:44:57,588 - INFO -   - Analyzing and formatting 'Collection date'
2025-08-30 16:45:07,669 - INFO -     Removed 423 rows with incomplete 'XXXX' dates.
2025-08-30 16:45:18,022 - INFO -     Date format statistics for 'Collection date':
2025-08-30 16:45:18,022 - INFO -       YYYY-MM-DD format: 4999796
2025-08-30 16:45:18,022 - INFO -       YYYY-MM format   : 17741
2025-08-30 16:45:18,023 - INFO -       YYYY format      : 10981
2025-08-30 16:45:18,023 - INFO -       Other/unparseable: 624
2025-08-30 16:45:18,023 - INFO -       Missing (NA)     : 11
2025-08-30 16:45:29,352 - INFO -   - Analyzing and formatting 'Submission date'
2025-08-30 16:45:41,479 - INFO -     Date format statistics for 'Submission date':
2025-08-30 16:45:41,480 - INFO -       YYYY-MM-DD format: 5029153
2025-08-30 16:45:41,480 - INFO -       YYYY-MM format   : 0
2025-08-30 16:45:41,480 - INFO -       YYYY format      : 0
2025-08-30 16:45:41,480 - INFO -       Other/unparseable: 0
2025-08-30 16:45:41,480 - INFO -       Missing (NA)     : 0
2025-08-30 16:45:56,234 - INFO - Formatting 'Location' column by combining 'region' and 'country'...
2025-08-30 16:46:56,822 - INFO - Preprocessing complete. Final dataset has 5029153 rows.
2025-08-30 16:47:03,952 - INFO - Saving processed metadata (5029153 rows) to data/processed/sars-cov-2/metadata.tsv...
2025-08-30 16:48:17,162 - INFO - Saving 4340420 quality-filtered sequence IDs to data/processed/sars-cov-2/filtered_sequence_ids.txt...
2025-08-30 16:48:17,680 - INFO - Saving 0 non-classified sequence IDs to data/processed/sars-cov-2/non_classified_sequence_ids.txt...
2025-08-30 16:48:17,680 - INFO - Script finished successfully.
